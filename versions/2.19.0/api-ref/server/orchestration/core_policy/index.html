
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.prefect.io/latest/api-ref/server/orchestration/core_policy/">
      
      
        <link rel="prev" href="../policies/">
      
      
        <link rel="next" href="../global_policy/">
      
      
        
      
      
      <link rel="icon" href="../../../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17+insiders-4.53.5">
    
    
      
        <title>server.orchestration.core_policy - Prefect Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.ab3d5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/theme.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/admonitions.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/api_ref.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/rest_ref.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/syntax_highlights.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/termynal.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    

      
  


  <script src="../../../../assets/external/cdn.amplitude.com/libs/analytics-browser-1.9.1-min.js.gz.js"></script>
<script type="text/javascript">
const amplitudeKey = "c97dd2acbf306ab7bf54aca0aeb7ffa1"
const amplitudeUrl = "/2/httpapi"

const addUrl = (event) => {
  const deviceId = amplitude.getDeviceId()
  const { href = '' } = event.target
  const url = new URL(href)
  url.searchParams.set('deviceId', deviceId)
  event.target.href = url.toString()
}

const removeUrl = (event) => {
  const { href = '' } = event.target
  const url = new URL(href)
  url.searchParams.delete('deviceId')
  event.target.href = url.toString()
}

const urls = [
  'https://app.prefect.cloud',
  'https://app.stg.prefect.dev',
  'https://app.prefect.dev',
]

const selector = urls.map((url) => `a[href^="${url}"]`).join(',')

const addDeviceIdToAppLinks = () => {
  const elements = document.querySelectorAll(selector)

  elements.forEach((element) => {
    element.addEventListener('mouseenter', addUrl)
    element.addEventListener('mouseleave', removeUrl)
    element.addEventListener('focus', addUrl)
    element.addEventListener('blur', removeUrl)
    element.addEventListener('touchstart', addUrl)
    element.addEventListener('touchend', removeUrl)
  })
}


const init = () => {
  amplitude.init(amplitudeKey, undefined, {
    useBatch: true,
    serverUrl: amplitudeUrl,
    attribution: {
      disabled: false,
      trackNewCampaigns: true,
      trackPageViews: true,
      resetSessionOnNewCampaign: true,
    },
    defaultTracking: {
      pageViews: {
        trackOn: function() { return true},
        eventType: "Page View: Docs",
        trackHistoryChanges: "all",
      },
      sessions: false,
      formInteractions: true,
      fileDownloads: true,
    },
  })
}

function trackPageView() {
  amplitude.track(
    'Page View: Docs',
    {
      'url': window.href,
      'title': document.title,
      'referrer': document.referrer,
      'path': window.location.pathname
    }
  )
}

if (amplitudeKey){
  document.addEventListener("DOMContentLoaded", function() {
      init()
      setTimeout(addDeviceIdToAppLinks)
      setTimeout(trackPageView)
  });
}
</script>


  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-3M31G9B0QJ"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-3M31G9B0QJ",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-3M31G9B0QJ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    

    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="#0225AC" data-md-color-accent="#0225AC">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prefect.server.orchestration.core_policy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're viewing the docs for Prefect 2.19.0.
  <a href="../../../../.."> 
    <strong>Click here to view the latest docs.</strong>
  </a>

  <script type="text/javascript">
    // extract the version from the URL
    var version = window.location.pathname.split('/')[1];
    console.log("version is latest!")
    // check if the version is 'latest'
    var showVersionBanner = version !== 'latest';
    
    // hide the announcement bar if we're not showing the latest version of the docs
    // wait until dom is loaded
    document.addEventListener("DOMContentLoaded", function(event) {
      if (showVersionBanner) {
        document.querySelector('[data-md-component="announce"]').setAttribute('hidden', '');
      }
    });
  </script>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      <!-- overrides partial for header, adding tab for Prefect Cloud -->




<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Prefect Docs"
      class="md-header__button md-logo" aria-label="Prefect Docs" data-md-component="logo">
      
  <img src="../../../../img/logos/prefect-logo-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Prefect Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
            server.orchestration.core_policy
            
          </span>
        </div>
      </div>
    </div>
    
    
    <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="#0225AC" data-md-color-accent="#0225AC"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="#0225AC" data-md-color-accent="#0225AC"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
    
    
    
    <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    <label class="md-header__button md-icon" for="__search">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
    </label>
    <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
    <div class="md-header__source">
      <a href="https://github.com/PrefectHQ/prefect" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
    

    <!-- adding tab for Prefect Cloud -->
    <a class="md-button cloud-button list-unstyled" target="_blank" rel="noopener noreferrer" href="https://app.prefect.cloud"><b>Try Prefect
        Cloud â†’</b></a>
    <!-- end adding Perfect Cloud button-->

  </nav>
  
  
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Prefect Docs" class="md-nav__button md-logo" aria-label="Prefect Docs" data-md-component="logo">
      
  <img src="../../../../img/logos/prefect-logo-white.svg" alt="logo">

    </a>
    Prefect Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PrefectHQ/prefect" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tutorial/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Tutorial
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorial
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorial/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorial/tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Tasks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorial/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorial/work-pools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Work Pools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorial/workers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Workers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../guides/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    How-to Guides
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-to Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/host/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Hosting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Profiles & Settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/global-concurrency-limits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Global Concurrency Limits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/runtime-context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Runtime Context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/using-the-client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Prefect Client
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/creating-interactive-workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Interactive Workflows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/automations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Automations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/webhooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Webhooks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://registry.terraform.io/providers/PrefectHQ/prefect/latest/docs/guides/getting-started" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Terraform Provider
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/ci-cd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    CI/CD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/specifying-upstream-dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Specifying Upstream Dependencies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/secrets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Third-party Secrets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../recipes/recipes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Recipes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Execution
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Execution
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/state-change-hooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    State Change Hooks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/dask-ray-task-runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Dask & Ray
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/moving-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Read and Write Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/big-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Big Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/managed-execution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Managed Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/cli-shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Shell Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Work Pools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Work Pools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/prefect-deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Deploying Flows to Work pools and Workers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/upgrade-guide-agents-to-workers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Upgrade from Agents to Workers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/deployment/storage-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Flow Code Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/deployment/kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/deployment/push-work-pools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Serverless Push Work Pools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/deployment/serverless-workers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Serverless Work Pools with Workers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/deployment/daemonize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Daemonize Processes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/deployment/developing-a-new-worker-type/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Custom Workers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/deployment/overriding-job-variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Job Variable Overrides
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../concepts/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Tasks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/work-pools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Work Pools & Workers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/schedules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Schedules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Results
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/artifacts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Artifacts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    States
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/blocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Blocks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/task-runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Task Runners
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/automations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Automations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Block and Agent-Based Deployments
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Block and Agent-Based Deployments
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/deployments-block-based/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/infrastructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/agents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../cloud/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Cloud
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cloud
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/workspaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Workspaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../cloud/users/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Users
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Users
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/roles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Roles (RBAC)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/api-keys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    API Keys
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/service-accounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Service Accounts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/sso/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Single Sign-On (SSO)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/audit-log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Audit Log
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/object-access-control-lists/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Object-Level Access Control Lists
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/teams/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Teams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/rate-limits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    API Rate Limits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/connecting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Connecting & Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/incidents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Incidents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Using Integrations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Contributing Integrations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Libraries
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Libraries
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-aws/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    AWS
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_1" id="__nav_6_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    AWS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_6_4_1_2" id="__nav_6_4_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/ecs_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Setting up an ECS Worker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Batch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/client_waiter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Client Waiter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/ecs_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ECS Worker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/ecs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ECS (deprecated)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/glue_job/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Glue Job
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/lambda_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Lambda
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_1_10" >
        
          
          <label class="md-nav__link" for="__nav_6_4_1_10" id="__nav_6_4_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_1_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Deployments
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/deployments/steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Steps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/s3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    S3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-aws/secrets_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Secrets Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-azure/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Azure
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_2" id="__nav_6_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Azure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-azure/aci_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ACI Worker Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-azure/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-azure/blob_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Blob Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-azure/cosmos_db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cosmos DB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-azure/ml_datastore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    ML Datastore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-azure/container_instance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Container Instance Block
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-azure/container_instance_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Container Instance Worker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_2_9" >
        
          
          <label class="md-nav__link" for="__nav_6_4_2_9" id="__nav_6_4_2_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Deployments
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-azure/deployments/steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Steps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-bitbucket/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Bitbucket
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_3" id="__nav_6_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bitbucket
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-bitbucket/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-bitbucket/repositories.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Repositories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-dask/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Dask
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_4" id="__nav_6_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Dask
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dask/usage_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Usage Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dask/task_runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Task Runners
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dask/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-databricks/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Databricks
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_5" id="__nav_6_4_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Databricks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-databricks/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-databricks/jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Jobs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-databricks/rest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Rest
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-databricks/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-dbt/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    dbt
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_6" id="__nav_6_4_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    dbt
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_4_6_2" id="__nav_6_4_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Cloud
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cloud
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cloud/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cloud/jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Jobs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cloud/runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cloud/clients/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Clients
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cloud/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cloud/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_4_6_3" id="__nav_6_4_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_6_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    CLI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cli/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cli/commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_6_3_3" >
        
          
          <label class="md-nav__link" for="__nav_6_4_6_3_3" id="__nav_6_4_6_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Configs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_6_4_6_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_6_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Configs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cli/configs/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cli/configs/bigquery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    BigQuery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cli/configs/postgres/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Postgres
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-dbt/cli/configs/snowflake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Snowflake
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-docker/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_7" id="__nav_6_4_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Docker
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-docker/host/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Host
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-docker/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-docker/containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Containers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-docker/images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Images
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_7_6" >
        
          
          <label class="md-nav__link" for="__nav_6_4_7_6" id="__nav_6_4_7_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_7_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Deployments
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-docker/deployments/steps.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Steps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-docker/worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Worker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-email/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Email
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_8" id="__nav_6_4_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Email
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-email/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-email/message/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Message
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-gcp/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    GCP
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_9" id="__nav_6_4_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    GCP
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/gcp-worker-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Google Cloud Run Execution Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/cloud_storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cloud Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/bigquery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    BigQuery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/secret_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Secret Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/cloud_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cloud Run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/aiplatform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    AI Platform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/deployments/steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Deployment Steps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_9_10" >
        
          
          <label class="md-nav__link" for="__nav_6_4_9_10" id="__nav_6_4_9_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Workers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_4_9_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_9_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Workers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/cloud_run_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cloud Run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cintegrations/prefect-gcp/loud_run_worker_v2.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cloud Run V2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gcp/vertex_worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Vertex AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-github/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    GitHub
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_10" id="__nav_6_4_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    GitHub
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/graphql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Graphql
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/mutations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Mutations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/organization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Organization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/repository/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Repository
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/repository_owner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Repository Owner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/user/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    User
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/viewer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Viewer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-github/schemas/graphql_schema.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Graphql Schema
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-gitlab/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Gitlab
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_11" id="__nav_6_4_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Gitlab
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gitlab/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-gitlab/repositories/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Repositories
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-kubernetes/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_12" id="__nav_6_4_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Kubernetes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/custom_objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Custom Objects
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Jobs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/pods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Pods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-kubernetes/worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Worker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_13" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-ray/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Ray
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_13" id="__nav_6_4_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Ray
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-ray/task-runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Task Runners
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_14" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-shell/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Shell
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_14" id="__nav_6_4_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    Shell
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-shell/commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_15" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-slack/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Slack
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_15" id="__nav_6_4_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    Slack
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-slack/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-slack/messages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Messages
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_16" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-snowflake/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Snowflake
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_16" id="__nav_6_4_16_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_16">
            <span class="md-nav__icon md-icon"></span>
            
  
    Snowflake
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-snowflake/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-snowflake/database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4_17" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/prefect-sqlalchemy/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    SQLAlchemy
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4_17" id="__nav_6_4_17_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_4_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4_17">
            <span class="md-nav__icon md-icon"></span>
            
  
    SQLAlchemy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-sqlalchemy/credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Credentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/prefect-sqlalchemy/database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../python/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Python SDK
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Python SDK
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/artifacts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.artifacts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/automations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.automations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_5" >
        
          
          <label class="md-nav__link" for="__nav_7_2_5" id="__nav_7_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.blocks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.blocks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    fields
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/notifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    notifications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    system
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/webhook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    webhook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_6" >
        
          
          <label class="md-nav__link" for="__nav_7_2_6" id="__nav_7_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.client
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.client
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    cloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/orchestration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    orchestration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_7" >
        
          
          <label class="md-nav__link" for="__nav_7_2_7" id="__nav_7_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.cli
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.cli
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/artifact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    artifact
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/block/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    block
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    cloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/cloud.webhook.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    cloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/concurrency_limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    concurrency_limit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    deploy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    dev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/flow_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    flow_run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/profile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    profile
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/project.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    project
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/root/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    root
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    shell
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/variable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    variable
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/work_pool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    work_pool
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/work_queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    work_queue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    worker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_9" >
        
          
          <label class="md-nav__link" for="__nav_7_2_9" id="__nav_7_2_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.concurrency
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.concurrency
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/concurrency/asyncio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    asyncio
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/concurrency/events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/concurrency/services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/concurrency/sync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    sync
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_10" >
        
          
          <label class="md-nav__link" for="__nav_7_2_10" id="__nav_7_2_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.deployments
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.deployments
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/deployments/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/deployments/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/deployments/runner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    runner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/deployments/steps/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    steps.core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/deployments/steps/pull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    steps.pull
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/deployments/steps/utility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    steps.utility
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.filesystems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/flow_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.flow_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/futures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.futures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/infrastructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_19" >
        
          
          <label class="md-nav__link" for="__nav_7_2_19" id="__nav_7_2_19_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.input
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_19">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.input
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/input/actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    actions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/input/run_input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    run_input
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_20" >
        
          
          <label class="md-nav__link" for="__nav_7_2_20" id="__nav_7_2_20_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.logging
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_20_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_20">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.logging
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/logging/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/logging/formatters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    formatters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/logging/handlers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    handlers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/logging/highlighters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    highlighters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/logging/loggers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    loggers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/manifests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.manifests
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_22" >
        
          
          <label class="md-nav__link" for="__nav_7_2_22" id="__nav_7_2_22_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.runner
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_22">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.runner
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runner/runner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    runner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runner/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runner/storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runner/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_23" >
        
          
          <label class="md-nav__link" for="__nav_7_2_23" id="__nav_7_2_23_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.runtime
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_23">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.runtime
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runtime/flow_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    flow_run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runtime/deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runtime/task_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    task_run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/serializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.serializers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.software
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/task-runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.task_runners
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.tasks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_31" >
        
          
          <label class="md-nav__link" for="__nav_7_2_31" id="__nav_7_2_31_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.utilities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_31_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_31">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.utilities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    annotations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/asyncutils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    asyncutils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/callables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    callables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/collections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    collections
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/compat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    compat
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/dispatch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    dispatch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/dockerutils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    dockerutils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/filesystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    filesystem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/hashing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    hashing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/importtools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    importtools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/math/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    math
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/names/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    names
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/processutils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    processutils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/pydantic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    pydantic
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/render_swagger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    render_swagger
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/slugify/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    slugify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/templating/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    templating
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/text/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    text
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    visualization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_33" >
        
          
          <label class="md-nav__link" for="__nav_7_2_33" id="__nav_7_2_33_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.workers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_33_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_33">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.workers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/workers/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/workers/block/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    block
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/workers/process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/workers/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/workers/utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../rest-api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    REST API
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    REST API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://app.prefect.cloud/api/docs" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Prefect Cloud REST API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../rest-api-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Prefect Server REST API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Server API
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Server API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_2" >
        
          
          <label class="md-nav__link" for="__nav_7_4_2" id="__nav_7_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/admin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.admin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/csrf_token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.csrf_token
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.dependencies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/flow_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.flow_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/flow_run_states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.flow_run_states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/middleware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.middleware
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/run_history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.run_history
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/saved_searches/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.saved_searches
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/task_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.task_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/task_run_states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.task_run_states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_3" >
        
          
          <label class="md-nav__link" for="__nav_7_4_3" id="__nav_7_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/csrf_token/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.csrf_token
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/flow_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.flow_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/flow_run_states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.flow_run_states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/task_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.task_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/task_run_states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.task_run_states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/saved_searches/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.saved_searches
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_4" checked>
        
          
          <label class="md-nav__link" for="__nav_7_4_4" id="__nav_7_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Orchestration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Orchestration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.orchestration.rules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.orchestration.policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    
  
    server.orchestration.core_policy
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    
  
    server.orchestration.core_policy
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CoreFlowPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        CoreFlowPolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CoreTaskPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        CoreTaskPolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.AutonomousTaskPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        AutonomousTaskPolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.SecureTaskConcurrencySlots" class="md-nav__link">
    <span class="md-ellipsis">
      
        SecureTaskConcurrencySlots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.ReleaseTaskConcurrencySlots" class="md-nav__link">
    <span class="md-ellipsis">
      
        ReleaseTaskConcurrencySlots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.AddUnknownResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        AddUnknownResult
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CacheInsertion" class="md-nav__link">
    <span class="md-ellipsis">
      
        CacheInsertion
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CacheRetrieval" class="md-nav__link">
    <span class="md-ellipsis">
      
        CacheRetrieval
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.RetryFailedFlows" class="md-nav__link">
    <span class="md-ellipsis">
      
        RetryFailedFlows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.RetryFailedTasks" class="md-nav__link">
    <span class="md-ellipsis">
      
        RetryFailedTasks
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.EnqueueScheduledTasks" class="md-nav__link">
    <span class="md-ellipsis">
      
        EnqueueScheduledTasks
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.RenameReruns" class="md-nav__link">
    <span class="md-ellipsis">
      
        RenameReruns
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CopyScheduledTime" class="md-nav__link">
    <span class="md-ellipsis">
      
        CopyScheduledTime
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.WaitForScheduledTime" class="md-nav__link">
    <span class="md-ellipsis">
      
        WaitForScheduledTime
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.HandlePausingFlows" class="md-nav__link">
    <span class="md-ellipsis">
      
        HandlePausingFlows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.HandleResumingPausedFlows" class="md-nav__link">
    <span class="md-ellipsis">
      
        HandleResumingPausedFlows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.UpdateFlowRunTrackerOnTasks" class="md-nav__link">
    <span class="md-ellipsis">
      
        UpdateFlowRunTrackerOnTasks
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.HandleTaskTerminalStateTransitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        HandleTaskTerminalStateTransitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.HandleFlowTerminalStateTransitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        HandleFlowTerminalStateTransitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.PreventPendingTransitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        PreventPendingTransitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.PreventRunningTasksFromStoppedFlows" class="md-nav__link">
    <span class="md-ellipsis">
      
        PreventRunningTasksFromStoppedFlows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.EnforceCancellingToCancelledTransition" class="md-nav__link">
    <span class="md-ellipsis">
      
        EnforceCancellingToCancelledTransition
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.BypassCancellingFlowRunsWithNoInfra" class="md-nav__link">
    <span class="md-ellipsis">
      
        BypassCancellingFlowRunsWithNoInfra
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.PreventDuplicateTransitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        PreventDuplicateTransitions
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../global_policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.orchestration.global_policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_5" >
        
          
          <label class="md-nav__link" for="__nav_7_4_5" id="__nav_7_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Schemas
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Schemas
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.actions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.filters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/responses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.responses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/schedules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.schedules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.sorting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_6" >
        
          
          <label class="md-nav__link" for="__nav_7_4_6" id="__nav_7_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/late_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.services.late_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/loop_service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.services.loop_service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/scheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.services.scheduler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_7" >
        
          
          <label class="md-nav__link" for="__nav_7_4_7" id="__nav_7_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utilities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.utilities.database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.utilities.schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.utilities.server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../community/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Community
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Community
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/style/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Style
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Versioning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CoreFlowPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        CoreFlowPolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CoreTaskPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        CoreTaskPolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.AutonomousTaskPolicy" class="md-nav__link">
    <span class="md-ellipsis">
      
        AutonomousTaskPolicy
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.SecureTaskConcurrencySlots" class="md-nav__link">
    <span class="md-ellipsis">
      
        SecureTaskConcurrencySlots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.ReleaseTaskConcurrencySlots" class="md-nav__link">
    <span class="md-ellipsis">
      
        ReleaseTaskConcurrencySlots
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.AddUnknownResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        AddUnknownResult
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CacheInsertion" class="md-nav__link">
    <span class="md-ellipsis">
      
        CacheInsertion
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CacheRetrieval" class="md-nav__link">
    <span class="md-ellipsis">
      
        CacheRetrieval
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.RetryFailedFlows" class="md-nav__link">
    <span class="md-ellipsis">
      
        RetryFailedFlows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.RetryFailedTasks" class="md-nav__link">
    <span class="md-ellipsis">
      
        RetryFailedTasks
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.EnqueueScheduledTasks" class="md-nav__link">
    <span class="md-ellipsis">
      
        EnqueueScheduledTasks
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.RenameReruns" class="md-nav__link">
    <span class="md-ellipsis">
      
        RenameReruns
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.CopyScheduledTime" class="md-nav__link">
    <span class="md-ellipsis">
      
        CopyScheduledTime
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.WaitForScheduledTime" class="md-nav__link">
    <span class="md-ellipsis">
      
        WaitForScheduledTime
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.HandlePausingFlows" class="md-nav__link">
    <span class="md-ellipsis">
      
        HandlePausingFlows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.HandleResumingPausedFlows" class="md-nav__link">
    <span class="md-ellipsis">
      
        HandleResumingPausedFlows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.UpdateFlowRunTrackerOnTasks" class="md-nav__link">
    <span class="md-ellipsis">
      
        UpdateFlowRunTrackerOnTasks
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.HandleTaskTerminalStateTransitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        HandleTaskTerminalStateTransitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.HandleFlowTerminalStateTransitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        HandleFlowTerminalStateTransitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.PreventPendingTransitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        PreventPendingTransitions
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.PreventRunningTasksFromStoppedFlows" class="md-nav__link">
    <span class="md-ellipsis">
      
        PreventRunningTasksFromStoppedFlows
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.EnforceCancellingToCancelledTransition" class="md-nav__link">
    <span class="md-ellipsis">
      
        EnforceCancellingToCancelledTransition
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.BypassCancellingFlowRunsWithNoInfra" class="md-nav__link">
    <span class="md-ellipsis">
      
        BypassCancellingFlowRunsWithNoInfra
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.core_policy.PreventDuplicateTransitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        PreventDuplicateTransitions
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                




  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
      
        
  
    
    
      <li class="md-path__item">
        <a href="../../../" class="md-path__link">
          
  <span class="md-ellipsis">
    API Reference
  </span>

        </a>
      </li>
    
  

      
        
  
    
    
      <li class="md-path__item">
        <a href="../../" class="md-path__link">
          
  <span class="md-ellipsis">
    Server API
  </span>

        </a>
      </li>
    
  

      
        
  
    
    
      <li class="md-path__item">
        <a href="../rules/" class="md-path__link">
          
  <span class="md-ellipsis">
    Orchestration
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/PrefectHQ/prefect/edit/main/docs/api-ref/server/orchestration/core_policy.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  


<div class="doc doc-object doc-module">



<h1 id="prefect.server.orchestration.core_policy" class="doc doc-heading">
          <code>prefect.server.orchestration.core_policy</code>


<a href="#prefect.server.orchestration.core_policy" class="headerlink" title="Permanent link">&para;</a></h1>

  <div class="doc doc-contents first">
  
      <p>Orchestration logic that fires on state transitions.</p>
<p><code>CoreFlowPolicy</code> and <code>CoreTaskPolicy</code> contain all default orchestration rules that
Prefect enforces on a state transition.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.CoreFlowPolicy" class="doc doc-heading">
          <code>CoreFlowPolicy</code>


<a href="#prefect.server.orchestration.core_policy.CoreFlowPolicy" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.policies.BaseOrchestrationPolicy" href="../policies/#prefect.server.orchestration.policies.BaseOrchestrationPolicy">BaseOrchestrationPolicy</a></code></p>

  
      <p>Orchestration rules that run against flow-run-state transitions in priority order.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CoreFlowPolicy</span><span class="p">(</span><span class="n">BaseOrchestrationPolicy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Orchestration rules that run against flow-run-state transitions in priority order.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">priority</span><span class="p">():</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">PreventDuplicateTransitions</span><span class="p">,</span>
            <span class="n">HandleFlowTerminalStateTransitions</span><span class="p">,</span>
            <span class="n">EnforceCancellingToCancelledTransition</span><span class="p">,</span>
            <span class="n">BypassCancellingFlowRunsWithNoInfra</span><span class="p">,</span>
            <span class="n">PreventPendingTransitions</span><span class="p">,</span>
            <span class="n">EnsureOnlyScheduledFlowsMarkedLate</span><span class="p">,</span>
            <span class="n">HandlePausingFlows</span><span class="p">,</span>
            <span class="n">HandleResumingPausedFlows</span><span class="p">,</span>
            <span class="n">CopyScheduledTime</span><span class="p">,</span>
            <span class="n">WaitForScheduledTime</span><span class="p">,</span>
            <span class="n">RetryFailedFlows</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">+</span> <span class="p">([</span><span class="n">InstrumentFlowRunStateTransitions</span><span class="p">]</span> <span class="k">if</span> <span class="n">PREFECT_EXPERIMENTAL_EVENTS</span> <span class="k">else</span> <span class="p">[])</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.CoreTaskPolicy" class="doc doc-heading">
          <code>CoreTaskPolicy</code>


<a href="#prefect.server.orchestration.core_policy.CoreTaskPolicy" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.policies.BaseOrchestrationPolicy" href="../policies/#prefect.server.orchestration.policies.BaseOrchestrationPolicy">BaseOrchestrationPolicy</a></code></p>

  
      <p>Orchestration rules that run against task-run-state transitions in priority order.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CoreTaskPolicy</span><span class="p">(</span><span class="n">BaseOrchestrationPolicy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Orchestration rules that run against task-run-state transitions in priority order.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">priority</span><span class="p">():</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">CacheRetrieval</span><span class="p">,</span>
            <span class="n">HandleTaskTerminalStateTransitions</span><span class="p">,</span>
            <span class="n">PreventRunningTasksFromStoppedFlows</span><span class="p">,</span>
            <span class="n">SecureTaskConcurrencySlots</span><span class="p">,</span>  <span class="c1"># retrieve cached states even if slots are full</span>
            <span class="n">CopyScheduledTime</span><span class="p">,</span>
            <span class="n">WaitForScheduledTime</span><span class="p">,</span>
            <span class="n">RetryFailedTasks</span><span class="p">,</span>
            <span class="n">RenameReruns</span><span class="p">,</span>
            <span class="n">UpdateFlowRunTrackerOnTasks</span><span class="p">,</span>
            <span class="n">CacheInsertion</span><span class="p">,</span>
            <span class="n">ReleaseTaskConcurrencySlots</span><span class="p">,</span>
        <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.AutonomousTaskPolicy" class="doc doc-heading">
          <code>AutonomousTaskPolicy</code>


<a href="#prefect.server.orchestration.core_policy.AutonomousTaskPolicy" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.policies.BaseOrchestrationPolicy" href="../policies/#prefect.server.orchestration.policies.BaseOrchestrationPolicy">BaseOrchestrationPolicy</a></code></p>

  
      <p>Orchestration rules that run against task-run-state transitions in priority order.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AutonomousTaskPolicy</span><span class="p">(</span><span class="n">BaseOrchestrationPolicy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Orchestration rules that run against task-run-state transitions in priority order.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">priority</span><span class="p">():</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">PreventPendingTransitions</span><span class="p">,</span>
            <span class="n">CacheRetrieval</span><span class="p">,</span>
            <span class="n">HandleTaskTerminalStateTransitions</span><span class="p">,</span>
            <span class="n">SecureTaskConcurrencySlots</span><span class="p">,</span>  <span class="c1"># retrieve cached states even if slots are full</span>
            <span class="n">CopyScheduledTime</span><span class="p">,</span>
            <span class="n">WaitForScheduledTime</span><span class="p">,</span>
            <span class="n">RetryFailedTasks</span><span class="p">,</span>
            <span class="n">RenameReruns</span><span class="p">,</span>
            <span class="n">UpdateFlowRunTrackerOnTasks</span><span class="p">,</span>
            <span class="n">CacheInsertion</span><span class="p">,</span>
            <span class="n">ReleaseTaskConcurrencySlots</span><span class="p">,</span>
            <span class="n">EnqueueScheduledTasks</span><span class="p">,</span>
        <span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.SecureTaskConcurrencySlots" class="doc doc-heading">
          <code>SecureTaskConcurrencySlots</code>


<a href="#prefect.server.orchestration.core_policy.SecureTaskConcurrencySlots" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Checks relevant concurrency slots are available before entering a Running state.</p>
<p>This rule checks if concurrency limits have been set on the tags associated with a
TaskRun. If so, a concurrency slot will be secured against each concurrency limit
before being allowed to transition into a running state. If a concurrency limit has
been reached, the client will be instructed to delay the transition for the duration
specified by the "PREFECT_TASK_RUN_TAG_CONCURRENCY_SLOT_WAIT_SECONDS" setting
before trying again. If the concurrency limit set on a tag is 0, the transition will
be aborted to prevent deadlocks.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SecureTaskConcurrencySlots</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks relevant concurrency slots are available before entering a Running state.</span>

<span class="sd">    This rule checks if concurrency limits have been set on the tags associated with a</span>
<span class="sd">    TaskRun. If so, a concurrency slot will be secured against each concurrency limit</span>
<span class="sd">    before being allowed to transition into a running state. If a concurrency limit has</span>
<span class="sd">    been reached, the client will be instructed to delay the transition for the duration</span>
<span class="sd">    specified by the &quot;PREFECT_TASK_RUN_TAG_CONCURRENCY_SLOT_WAIT_SECONDS&quot; setting</span>
<span class="sd">    before trying again. If the concurrency limit set on a tag is 0, the transition will</span>
<span class="sd">    be aborted to prevent deadlocks.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_applied_limits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">filtered_limits</span> <span class="o">=</span> <span class="p">(</span>
            <span class="k">await</span> <span class="n">concurrency_limits</span><span class="o">.</span><span class="n">filter_concurrency_limits_for_orchestration</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">tags</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">run_limits</span> <span class="o">=</span> <span class="p">{</span><span class="n">limit</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span> <span class="n">limit</span> <span class="k">for</span> <span class="n">limit</span> <span class="ow">in</span> <span class="n">filtered_limits</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">run_limits</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">concurrency_limit</span>
            <span class="k">if</span> <span class="n">limit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># limits of 0 will deadlock, and the transition needs to abort</span>
                <span class="k">for</span> <span class="n">stale_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applied_limits</span><span class="p">:</span>
                    <span class="n">stale_limit</span> <span class="o">=</span> <span class="n">run_limits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stale_tag</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="n">active_slots</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stale_limit</span><span class="o">.</span><span class="n">active_slots</span><span class="p">)</span>
                    <span class="n">active_slots</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                    <span class="n">stale_limit</span><span class="o">.</span><span class="n">active_slots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">active_slots</span><span class="p">)</span>

                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span>
                    <span class="n">reason</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;The concurrency limit on tag &quot;</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s1">&quot; is 0 and will deadlock&#39;</span>
                        <span class="s2">&quot; if the task tries to run again.&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">active_slots</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">limit</span><span class="p">:</span>
                <span class="c1"># if the limit has already been reached, delay the transition</span>
                <span class="k">for</span> <span class="n">stale_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applied_limits</span><span class="p">:</span>
                    <span class="n">stale_limit</span> <span class="o">=</span> <span class="n">run_limits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">stale_tag</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="n">active_slots</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stale_limit</span><span class="o">.</span><span class="n">active_slots</span><span class="p">)</span>
                    <span class="n">active_slots</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                    <span class="n">stale_limit</span><span class="o">.</span><span class="n">active_slots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">active_slots</span><span class="p">)</span>

                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay_transition</span><span class="p">(</span>
                    <span class="n">PREFECT_TASK_RUN_TAG_CONCURRENCY_SLOT_WAIT_SECONDS</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                    <span class="sa">f</span><span class="s2">&quot;Concurrency limit for the </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2"> tag has been reached&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># log the TaskRun ID to active_slots</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_applied_limits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
                <span class="n">active_slots</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">active_slots</span><span class="p">)</span>
                <span class="n">active_slots</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                <span class="n">cl</span><span class="o">.</span><span class="n">active_slots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">active_slots</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applied_limits</span><span class="p">:</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="k">await</span> <span class="n">concurrency_limits</span><span class="o">.</span><span class="n">read_concurrency_limit_by_tag</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">tag</span>
            <span class="p">)</span>
            <span class="n">active_slots</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">active_slots</span><span class="p">)</span>
            <span class="n">active_slots</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
            <span class="n">cl</span><span class="o">.</span><span class="n">active_slots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">active_slots</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.ReleaseTaskConcurrencySlots" class="doc doc-heading">
          <code>ReleaseTaskConcurrencySlots</code>


<a href="#prefect.server.orchestration.core_policy.ReleaseTaskConcurrencySlots" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseUniversalTransform" href="../rules/#prefect.server.orchestration.rules.BaseUniversalTransform">BaseUniversalTransform</a></code></p>

  
      <p>Releases any concurrency slots held by a run upon exiting a Running or
Cancelling state.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ReleaseTaskConcurrencySlots</span><span class="p">(</span><span class="n">BaseUniversalTransform</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Releases any concurrency slots held by a run upon exiting a Running or</span>
<span class="sd">    Cancelling state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nullified_transition</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">validated_state</span> <span class="ow">and</span> <span class="n">context</span><span class="o">.</span><span class="n">validated_state</span><span class="o">.</span><span class="n">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">,</span>
            <span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="o">.</span><span class="n">CANCELLING</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">filtered_limits</span> <span class="o">=</span> <span class="p">(</span>
                <span class="k">await</span> <span class="n">concurrency_limits</span><span class="o">.</span><span class="n">filter_concurrency_limits_for_orchestration</span><span class="p">(</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">tags</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">run_limits</span> <span class="o">=</span> <span class="p">{</span><span class="n">limit</span><span class="o">.</span><span class="n">tag</span><span class="p">:</span> <span class="n">limit</span> <span class="k">for</span> <span class="n">limit</span> <span class="ow">in</span> <span class="n">filtered_limits</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">run_limits</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">active_slots</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cl</span><span class="o">.</span><span class="n">active_slots</span><span class="p">)</span>
                <span class="n">active_slots</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
                <span class="n">cl</span><span class="o">.</span><span class="n">active_slots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">active_slots</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.AddUnknownResult" class="doc doc-heading">
          <code>AddUnknownResult</code>


<a href="#prefect.server.orchestration.core_policy.AddUnknownResult" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Assign an "unknown" result to runs that are forced to complete from a
failed or crashed state, if the previous state used a persisted result.</p>
<p>When we retry a flow run, we retry any task runs that were in a failed or
crashed state, but we also retry completed task runs that didn't use a
persisted result. This means that without a sentinel value for unknown
results, a task run forced into Completed state will always get rerun if the
flow run retries because the task run lacks a persisted result. The
"unknown" sentinel ensures that when we see a completed task run with an
unknown result, we know that it was forced to complete and we shouldn't
rerun it.</p>
<p>Flow runs forced into a Completed state have a similar problem: without a
sentinel value, attempting to refer to the flow run's result will raise an
exception because the flow run has no result. The sentinel ensures that we
can distinguish between a flow run that has no result and a flow run that
has an unknown result.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AddUnknownResult</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Assign an &quot;unknown&quot; result to runs that are forced to complete from a</span>
<span class="sd">    failed or crashed state, if the previous state used a persisted result.</span>

<span class="sd">    When we retry a flow run, we retry any task runs that were in a failed or</span>
<span class="sd">    crashed state, but we also retry completed task runs that didn&#39;t use a</span>
<span class="sd">    persisted result. This means that without a sentinel value for unknown</span>
<span class="sd">    results, a task run forced into Completed state will always get rerun if the</span>
<span class="sd">    flow run retries because the task run lacks a persisted result. The</span>
<span class="sd">    &quot;unknown&quot; sentinel ensures that when we see a completed task run with an</span>
<span class="sd">    unknown result, we know that it was forced to complete and we shouldn&#39;t</span>
<span class="sd">    rerun it.</span>

<span class="sd">    Flow runs forced into a Completed state have a similar problem: without a</span>
<span class="sd">    sentinel value, attempting to refer to the flow run&#39;s result will raise an</span>
<span class="sd">    exception because the flow run has no result. The sentinel ensures that we</span>
<span class="sd">    can distinguish between a flow run that has no result and a flow run that</span>
<span class="sd">    has an unknown result.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">FAILED</span><span class="p">,</span> <span class="n">StateType</span><span class="o">.</span><span class="n">CRASHED</span><span class="p">]</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">initial_state</span>
            <span class="ow">and</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">data</span>
            <span class="ow">and</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;reference&quot;</span>
        <span class="p">):</span>
            <span class="n">unknown_result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">UnknownResult</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">unknown_result</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.CacheInsertion" class="doc doc-heading">
          <code>CacheInsertion</code>


<a href="#prefect.server.orchestration.core_policy.CacheInsertion" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Caches completed states with cache keys after they are validated.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CacheInsertion</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Caches completed states with cache keys after they are validated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">]</span>

    <span class="nd">@inject_db</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
        <span class="n">db</span><span class="p">:</span> <span class="n">PrefectDBInterface</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">validated_state</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">session</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">cache_key</span> <span class="o">=</span> <span class="n">validated_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">cache_key</span>
        <span class="k">if</span> <span class="n">cache_key</span><span class="p">:</span>
            <span class="n">new_cache_item</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">TaskRunStateCache</span><span class="p">(</span>
                <span class="n">cache_key</span><span class="o">=</span><span class="n">cache_key</span><span class="p">,</span>
                <span class="n">cache_expiration</span><span class="o">=</span><span class="n">validated_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">cache_expiration</span><span class="p">,</span>
                <span class="n">task_run_state_id</span><span class="o">=</span><span class="n">validated_state</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_cache_item</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.CacheRetrieval" class="doc doc-heading">
          <code>CacheRetrieval</code>


<a href="#prefect.server.orchestration.core_policy.CacheRetrieval" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Rejects running states if a completed state has been cached.</p>
<p>This rule rejects transitions into a running state with a cache key if the key
has already been associated with a completed state in the cache table. The client
will be instructed to transition into the cached completed state instead.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CacheRetrieval</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rejects running states if a completed state has been cached.</span>

<span class="sd">    This rule rejects transitions into a running state with a cache key if the key</span>
<span class="sd">    has already been associated with a completed state in the cache table. The client</span>
<span class="sd">    will be instructed to transition into the cached completed state instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">]</span>

    <span class="nd">@inject_db</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
        <span class="n">db</span><span class="p">:</span> <span class="n">PrefectDBInterface</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">cache_key</span>
        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">refresh_cache</span><span class="p">:</span>
            <span class="c1"># Check for cached states matching the cache key</span>
            <span class="n">cached_state_id</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">select</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">TaskRunStateCache</span><span class="o">.</span><span class="n">task_run_state_id</span><span class="p">)</span>
                <span class="o">.</span><span class="n">where</span><span class="p">(</span>
                    <span class="n">sa</span><span class="o">.</span><span class="n">and_</span><span class="p">(</span>
                        <span class="n">db</span><span class="o">.</span><span class="n">TaskRunStateCache</span><span class="o">.</span><span class="n">cache_key</span> <span class="o">==</span> <span class="n">cache_key</span><span class="p">,</span>
                        <span class="n">sa</span><span class="o">.</span><span class="n">or_</span><span class="p">(</span>
                            <span class="n">db</span><span class="o">.</span><span class="n">TaskRunStateCache</span><span class="o">.</span><span class="n">cache_expiration</span><span class="o">.</span><span class="n">is_</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
                            <span class="n">db</span><span class="o">.</span><span class="n">TaskRunStateCache</span><span class="o">.</span><span class="n">cache_expiration</span> <span class="o">&gt;</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="s2">&quot;utc&quot;</span><span class="p">),</span>
                        <span class="p">),</span>
                    <span class="p">),</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">TaskRunStateCache</span><span class="o">.</span><span class="n">created</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>
                <span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">scalar_subquery</span><span class="p">()</span>
            <span class="n">query</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">TaskRunState</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">TaskRunState</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">cached_state_id</span><span class="p">)</span>
            <span class="n">cached_state</span> <span class="o">=</span> <span class="p">(</span><span class="k">await</span> <span class="n">context</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">))</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cached_state</span><span class="p">:</span>
                <span class="n">new_state</span> <span class="o">=</span> <span class="n">cached_state</span><span class="o">.</span><span class="n">as_state</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">reset_fields</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">new_state</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Cached&quot;</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                    <span class="n">state</span><span class="o">=</span><span class="n">new_state</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Retrieved state from cache&quot;</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.RetryFailedFlows" class="doc doc-heading">
          <code>RetryFailedFlows</code>


<a href="#prefect.server.orchestration.core_policy.RetryFailedFlows" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Rejects failed states and schedules a retry if the retry limit has not been reached.</p>
<p>This rule rejects transitions into a failed state if <code>retries</code> has been
set and the run count has not reached the specified limit. The client will be
instructed to transition into a scheduled state to retry flow execution.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RetryFailedFlows</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rejects failed states and schedules a retry if the retry limit has not been reached.</span>

<span class="sd">    This rule rejects transitions into a failed state if `retries` has been</span>
<span class="sd">    set and the run count has not reached the specified limit. The client will be</span>
<span class="sd">    instructed to transition into a scheduled state to retry flow execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">]</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">FAILED</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">FlowOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">run_settings</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run_settings</span>
        <span class="n">run_count</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">run_count</span>

        <span class="k">if</span> <span class="n">run_settings</span><span class="o">.</span><span class="n">retries</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">run_count</span> <span class="o">&gt;</span> <span class="n">run_settings</span><span class="o">.</span><span class="n">retries</span><span class="p">:</span>
            <span class="k">return</span>  <span class="c1"># Retry count exceeded, allow transition to failed</span>

        <span class="n">scheduled_start_time</span> <span class="o">=</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="s2">&quot;UTC&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
            <span class="n">seconds</span><span class="o">=</span><span class="n">run_settings</span><span class="o">.</span><span class="n">retry_delay</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="p">)</span>

        <span class="c1"># support old-style flow run retries for older clients</span>
        <span class="c1"># older flow retries require us to loop over failed tasks to update their state</span>
        <span class="c1"># this is not required after API version 0.8.3</span>
        <span class="n">api_version</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;api-version&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_version</span> <span class="ow">and</span> <span class="n">api_version</span> <span class="o">&lt;</span> <span class="n">Version</span><span class="p">(</span><span class="s2">&quot;0.8.3&quot;</span><span class="p">):</span>
            <span class="n">failed_task_runs</span> <span class="o">=</span> <span class="k">await</span> <span class="n">models</span><span class="o">.</span><span class="n">task_runs</span><span class="o">.</span><span class="n">read_task_runs</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">session</span><span class="p">,</span>
                <span class="n">flow_run_filter</span><span class="o">=</span><span class="n">filters</span><span class="o">.</span><span class="n">FlowRunFilter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;any_&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">]}),</span>
                <span class="n">task_run_filter</span><span class="o">=</span><span class="n">filters</span><span class="o">.</span><span class="n">TaskRunFilter</span><span class="p">(</span>
                    <span class="n">state</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;any_&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;FAILED&quot;</span><span class="p">]}}</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="n">failed_task_runs</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">models</span><span class="o">.</span><span class="n">task_runs</span><span class="o">.</span><span class="n">set_task_run_state</span><span class="p">(</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">session</span><span class="p">,</span>
                    <span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                    <span class="n">state</span><span class="o">=</span><span class="n">states</span><span class="o">.</span><span class="n">AwaitingRetry</span><span class="p">(</span><span class="n">scheduled_time</span><span class="o">=</span><span class="n">scheduled_start_time</span><span class="p">),</span>
                    <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="c1"># Reset the run count so that the task run retries still work correctly</span>
                <span class="n">run</span><span class="o">.</span><span class="n">run_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Reset pause metadata on retry</span>
        <span class="c1"># Pauses as a concept only exist after API version 0.8.4</span>
        <span class="n">api_version</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;api-version&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">api_version</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">api_version</span> <span class="o">&gt;=</span> <span class="n">Version</span><span class="p">(</span><span class="s2">&quot;0.8.4&quot;</span><span class="p">):</span>
            <span class="n">updated_policy</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
            <span class="n">updated_policy</span><span class="p">[</span><span class="s2">&quot;resuming&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">updated_policy</span><span class="p">[</span><span class="s2">&quot;pause_keys&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">FlowRunPolicy</span><span class="p">(</span><span class="o">**</span><span class="n">updated_policy</span><span class="p">)</span>

        <span class="c1"># Generate a new state for the flow</span>
        <span class="n">retry_state</span> <span class="o">=</span> <span class="n">states</span><span class="o">.</span><span class="n">AwaitingRetry</span><span class="p">(</span>
            <span class="n">scheduled_time</span><span class="o">=</span><span class="n">scheduled_start_time</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">retry_state</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Retrying&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.RetryFailedTasks" class="doc doc-heading">
          <code>RetryFailedTasks</code>


<a href="#prefect.server.orchestration.core_policy.RetryFailedTasks" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Rejects failed states and schedules a retry if the retry limit has not been reached.</p>
<p>This rule rejects transitions into a failed state if <code>retries</code> has been
set, the run count has not reached the specified limit, and the client
asserts it is a retriable task run. The client will be instructed to
transition into a scheduled state to retry task execution.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RetryFailedTasks</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rejects failed states and schedules a retry if the retry limit has not been reached.</span>

<span class="sd">    This rule rejects transitions into a failed state if `retries` has been</span>
<span class="sd">    set, the run count has not reached the specified limit, and the client</span>
<span class="sd">    asserts it is a retriable task run. The client will be instructed to</span>
<span class="sd">    transition into a scheduled state to retry task execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">]</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">FAILED</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">run_settings</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run_settings</span>
        <span class="n">run_count</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">run_count</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">run_settings</span><span class="o">.</span><span class="n">retry_delay</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">base_delay</span> <span class="o">=</span> <span class="n">delay</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">run_count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">base_delay</span> <span class="o">=</span> <span class="n">run_settings</span><span class="o">.</span><span class="n">retry_delay</span> <span class="ow">or</span> <span class="mi">0</span>

        <span class="c1"># guard against negative relative jitter inputs</span>
        <span class="k">if</span> <span class="n">run_settings</span><span class="o">.</span><span class="n">retry_jitter_factor</span><span class="p">:</span>
            <span class="n">delay</span> <span class="o">=</span> <span class="n">clamped_poisson_interval</span><span class="p">(</span>
                <span class="n">base_delay</span><span class="p">,</span> <span class="n">clamping_factor</span><span class="o">=</span><span class="n">run_settings</span><span class="o">.</span><span class="n">retry_jitter_factor</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">delay</span> <span class="o">=</span> <span class="n">base_delay</span>

        <span class="c1"># set by user to conditionally retry a task using @task(retry_condition_fn=...)</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">state_details</span><span class="p">,</span> <span class="s2">&quot;retriable&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">run_settings</span><span class="o">.</span><span class="n">retries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">run_count</span> <span class="o">&lt;=</span> <span class="n">run_settings</span><span class="o">.</span><span class="n">retries</span><span class="p">:</span>
            <span class="n">retry_state</span> <span class="o">=</span> <span class="n">states</span><span class="o">.</span><span class="n">AwaitingRetry</span><span class="p">(</span>
                <span class="n">scheduled_time</span><span class="o">=</span><span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="s2">&quot;UTC&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">delay</span><span class="p">),</span>
                <span class="n">message</span><span class="o">=</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">retry_state</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Retrying&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.EnqueueScheduledTasks" class="doc doc-heading">
          <code>EnqueueScheduledTasks</code>


<a href="#prefect.server.orchestration.core_policy.EnqueueScheduledTasks" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Enqueues autonomous task runs when they are scheduled</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EnqueueScheduledTasks</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enqueues autonomous task runs when they are scheduled</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">SCHEDULED</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">PREFECT_EXPERIMENTAL_ENABLE_TASK_SCHEDULING</span><span class="o">.</span><span class="n">value</span><span class="p">():</span>
            <span class="c1"># Only if task scheduling is enabled</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">validated_state</span><span class="p">:</span>
            <span class="c1"># Only if the transition was valid</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">flow_run_id</span><span class="p">:</span>
            <span class="c1"># Only for autonomous tasks</span>
            <span class="k">return</span>

        <span class="n">task_run</span><span class="p">:</span> <span class="n">TaskRun</span> <span class="o">=</span> <span class="n">TaskRun</span><span class="o">.</span><span class="n">from_orm</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="p">)</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="n">TaskQueue</span><span class="o">.</span><span class="n">for_key</span><span class="p">(</span><span class="n">task_run</span><span class="o">.</span><span class="n">task_key</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">validated_state</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;AwaitingRetry&quot;</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">queue</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">task_run</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">queue</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">task_run</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.RenameReruns" class="doc doc-heading">
          <code>RenameReruns</code>


<a href="#prefect.server.orchestration.core_policy.RenameReruns" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Name the states if they have run more than once.</p>
<p>In the special case where the initial state is an "AwaitingRetry" scheduled state,
the proposed state will be renamed to "Retrying" instead.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RenameReruns</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Name the states if they have run more than once.</span>

<span class="sd">    In the special case where the initial state is an &quot;AwaitingRetry&quot; scheduled state,</span>
<span class="sd">    the proposed state will be renamed to &quot;Retrying&quot; instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">run_count</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">run_count</span>
        <span class="k">if</span> <span class="n">run_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;AwaitingRetry&quot;</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename_state</span><span class="p">(</span><span class="s2">&quot;Retrying&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename_state</span><span class="p">(</span><span class="s2">&quot;Rerunning&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.CopyScheduledTime" class="doc doc-heading">
          <code>CopyScheduledTime</code>


<a href="#prefect.server.orchestration.core_policy.CopyScheduledTime" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Ensures scheduled time is copied from scheduled states to pending states.</p>
<p>If a new scheduled time has been proposed on the pending state, the scheduled time
on the scheduled state will be ignored.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CopyScheduledTime</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensures scheduled time is copied from scheduled states to pending states.</span>

<span class="sd">    If a new scheduled time has been proposed on the pending state, the scheduled time</span>
<span class="sd">    on the scheduled state will be ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">SCHEDULED</span><span class="p">]</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">PENDING</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">scheduled_time</span><span class="p">:</span>
            <span class="n">proposed_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">scheduled_time</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">initial_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">scheduled_time</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.WaitForScheduledTime" class="doc doc-heading">
          <code>WaitForScheduledTime</code>


<a href="#prefect.server.orchestration.core_policy.WaitForScheduledTime" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Prevents transitions to running states from happening to early.</p>
<p>This rule enforces that all scheduled states will only start with the machine clock
used by the Prefect REST API instance. This rule will identify transitions from scheduled
states that are too early and nullify them. Instead, no state will be written to the
database and the client will be sent an instruction to wait for <code>delay_seconds</code>
before attempting the transition again.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">WaitForScheduledTime</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prevents transitions to running states from happening to early.</span>

<span class="sd">    This rule enforces that all scheduled states will only start with the machine clock</span>
<span class="sd">    used by the Prefect REST API instance. This rule will identify transitions from scheduled</span>
<span class="sd">    states that are too early and nullify them. Instead, no state will be written to the</span>
<span class="sd">    database and the client will be sent an instruction to wait for `delay_seconds`</span>
<span class="sd">    before attempting the transition again.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">SCHEDULED</span><span class="p">,</span> <span class="n">StateType</span><span class="o">.</span><span class="n">PENDING</span><span class="p">]</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">scheduled_time</span> <span class="o">=</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">scheduled_time</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">scheduled_time</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># At this moment, we round delay to the nearest second as the API schema</span>
        <span class="c1"># specifies an integer return value.</span>
        <span class="n">delay</span> <span class="o">=</span> <span class="n">scheduled_time</span> <span class="o">-</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="s2">&quot;UTC&quot;</span><span class="p">)</span>
        <span class="n">delay_seconds</span> <span class="o">=</span> <span class="n">delay</span><span class="o">.</span><span class="n">in_seconds</span><span class="p">()</span>
        <span class="n">delay_seconds</span> <span class="o">+=</span> <span class="nb">round</span><span class="p">(</span><span class="n">delay</span><span class="o">.</span><span class="n">microseconds</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">delay_seconds</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay_transition</span><span class="p">(</span>
                <span class="n">delay_seconds</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Scheduled time is in the future&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.HandlePausingFlows" class="doc doc-heading">
          <code>HandlePausingFlows</code>


<a href="#prefect.server.orchestration.core_policy.HandlePausingFlows" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Governs runs attempting to enter a Paused/Suspended state</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HandlePausingFlows</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Governs runs attempting to enter a Paused/Suspended state</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">PAUSED</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">verb</span> <span class="o">=</span> <span class="s2">&quot;suspend&quot;</span> <span class="k">if</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Suspended&quot;</span> <span class="k">else</span> <span class="s2">&quot;pause&quot;</span>

        <span class="k">if</span> <span class="n">initial_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot </span><span class="si">{</span><span class="n">verb</span><span class="si">}</span><span class="s2"> flows with no state.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">is_running</span><span class="p">():</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">reason</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Cannot </span><span class="si">{</span><span class="n">verb</span><span class="si">}</span><span class="s2"> flows that are not currently running.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">pause_key</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># if no pause key is provided, default to a UUID</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span><span class="o">.</span><span class="n">pause_keys</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;This </span><span class="si">{</span><span class="n">verb</span><span class="si">}</span><span class="s2"> has already fired.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">pause_reschedule</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">parent_task_run_id</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span>
                    <span class="n">reason</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Cannot </span><span class="si">{</span><span class="n">verb</span><span class="si">}</span><span class="s2"> subflows.&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">deployment_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span>
                    <span class="n">reason</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Cannot </span><span class="si">{</span><span class="n">verb</span><span class="si">}</span><span class="s2"> flows without a deployment.&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">updated_policy</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
        <span class="n">updated_policy</span><span class="p">[</span><span class="s2">&quot;pause_keys&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">FlowRunPolicy</span><span class="p">(</span><span class="o">**</span><span class="n">updated_policy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.HandleResumingPausedFlows" class="doc doc-heading">
          <code>HandleResumingPausedFlows</code>


<a href="#prefect.server.orchestration.core_policy.HandleResumingPausedFlows" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Governs runs attempting to leave a Paused state</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HandleResumingPausedFlows</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Governs runs attempting to leave a Paused state</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">PAUSED</span><span class="p">]</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="n">proposed_state</span><span class="o">.</span><span class="n">is_running</span><span class="p">()</span>
            <span class="ow">or</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">is_scheduled</span><span class="p">()</span>
            <span class="ow">or</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">is_final</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">reason</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;This run cannot transition to the </span><span class="si">{</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> state&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; from the </span><span class="si">{</span><span class="n">initial_state</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> state.&quot;</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="n">verb</span> <span class="o">=</span> <span class="s2">&quot;suspend&quot;</span> <span class="k">if</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Suspended&quot;</span> <span class="k">else</span> <span class="s2">&quot;pause&quot;</span>

        <span class="k">if</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">pause_reschedule</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">deployment_id</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                    <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">reason</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Cannot reschedule a </span><span class="si">{</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2"> flow run&quot;</span>
                        <span class="s2">&quot; without a deployment.&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
                <span class="k">return</span>
        <span class="n">pause_timeout</span> <span class="o">=</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">pause_timeout</span>
        <span class="k">if</span> <span class="n">pause_timeout</span> <span class="ow">and</span> <span class="n">pause_timeout</span> <span class="o">&lt;</span> <span class="n">pendulum</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="s2">&quot;UTC&quot;</span><span class="p">):</span>
            <span class="n">pause_timeout_failure</span> <span class="o">=</span> <span class="n">states</span><span class="o">.</span><span class="n">Failed</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The flow was </span><span class="si">{</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="si">}</span><span class="s2"> and never resumed.&quot;</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                <span class="n">state</span><span class="o">=</span><span class="n">pause_timeout_failure</span><span class="p">,</span>
                <span class="n">reason</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;The flow run </span><span class="si">{</span><span class="n">verb</span><span class="si">}</span><span class="s2"> has timed out and can no longer resume.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">updated_policy</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
        <span class="n">updated_policy</span><span class="p">[</span><span class="s2">&quot;resuming&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">FlowRunPolicy</span><span class="p">(</span><span class="o">**</span><span class="n">updated_policy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.UpdateFlowRunTrackerOnTasks" class="doc doc-heading">
          <code>UpdateFlowRunTrackerOnTasks</code>


<a href="#prefect.server.orchestration.core_policy.UpdateFlowRunTrackerOnTasks" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Tracks the flow run attempt a task run state is associated with.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">UpdateFlowRunTrackerOnTasks</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tracks the flow run attempt a task run state is associated with.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">flow_run_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flow_run</span> <span class="o">=</span> <span class="k">await</span> <span class="n">context</span><span class="o">.</span><span class="n">flow_run</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_run</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">flow_run_run_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_run</span><span class="o">.</span><span class="n">run_count</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ObjectNotFoundError</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="s2">&quot;Unable to read flow run associated with task run:&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">, this flow run might have been deleted&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.HandleTaskTerminalStateTransitions" class="doc doc-heading">
          <code>HandleTaskTerminalStateTransitions</code>


<a href="#prefect.server.orchestration.core_policy.HandleTaskTerminalStateTransitions" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>We do not allow tasks to leave terminal states if:
- The task is completed and has a persisted result
- The task is going to CANCELLING / PAUSED / CRASHED</p>
<p>We reset the run count when a task leaves a terminal state for a non-terminal state
which resets task run retries; this is particularly relevant for flow run retries.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HandleTaskTerminalStateTransitions</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    We do not allow tasks to leave terminal states if:</span>
<span class="sd">    - The task is completed and has a persisted result</span>
<span class="sd">    - The task is going to CANCELLING / PAUSED / CRASHED</span>

<span class="sd">    We reset the run count when a task leaves a terminal state for a non-terminal state</span>
<span class="sd">    which resets task run retries; this is particularly relevant for flow run retries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">TERMINAL_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_run_count</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">run_count</span>

        <span class="c1"># Do not allow runs to be marked as crashed, paused, or cancelling if already terminal</span>
        <span class="k">if</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">{</span>
            <span class="n">StateType</span><span class="o">.</span><span class="n">CANCELLING</span><span class="p">,</span>
            <span class="n">StateType</span><span class="o">.</span><span class="n">PAUSED</span><span class="p">,</span>
            <span class="n">StateType</span><span class="o">.</span><span class="n">CRASHED</span><span class="p">,</span>
        <span class="p">}:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run is already </span><span class="si">{</span><span class="n">initial_state</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Only allow departure from a happily completed state if the result is not persisted</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">initial_state</span><span class="o">.</span><span class="n">is_completed</span><span class="p">()</span>
            <span class="ow">and</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">data</span>
            <span class="ow">and</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;unpersisted&quot;</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;This run is already completed.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">is_final</span><span class="p">():</span>
            <span class="c1"># Reset run count to reset retries</span>
            <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">run_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Change the name of the state to retrying if its a flow run retry</span>
        <span class="k">if</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">is_running</span><span class="p">()</span> <span class="ow">and</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">flow_run_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flow_run</span> <span class="o">=</span> <span class="k">await</span> <span class="n">context</span><span class="o">.</span><span class="n">flow_run</span><span class="p">()</span>
            <span class="n">flow_retrying</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">flow_run_run_count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_run</span><span class="o">.</span><span class="n">run_count</span>
            <span class="k">if</span> <span class="n">flow_retrying</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rename_state</span><span class="p">(</span><span class="s2">&quot;Retrying&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># reset run count</span>
        <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">run_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_run_count</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.HandleFlowTerminalStateTransitions" class="doc doc-heading">
          <code>HandleFlowTerminalStateTransitions</code>


<a href="#prefect.server.orchestration.core_policy.HandleFlowTerminalStateTransitions" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>We do not allow flows to leave terminal states if:
- The flow is completed and has a persisted result
- The flow is going to CANCELLING / PAUSED / CRASHED
- The flow is going to scheduled and has no deployment</p>
<p>We reset the pause metadata when a flow leaves a terminal state for a non-terminal
state. This resets pause behavior during manual flow run retries.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HandleFlowTerminalStateTransitions</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    We do not allow flows to leave terminal states if:</span>
<span class="sd">    - The flow is completed and has a persisted result</span>
<span class="sd">    - The flow is going to CANCELLING / PAUSED / CRASHED</span>
<span class="sd">    - The flow is going to scheduled and has no deployment</span>

<span class="sd">    We reset the pause metadata when a flow leaves a terminal state for a non-terminal</span>
<span class="sd">    state. This resets pause behavior during manual flow run retries.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">TERMINAL_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">FlowOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_flow_policy</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>

        <span class="c1"># Do not allow runs to be marked as crashed, paused, or cancelling if already terminal</span>
        <span class="k">if</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">{</span>
            <span class="n">StateType</span><span class="o">.</span><span class="n">CANCELLING</span><span class="p">,</span>
            <span class="n">StateType</span><span class="o">.</span><span class="n">PAUSED</span><span class="p">,</span>
            <span class="n">StateType</span><span class="o">.</span><span class="n">CRASHED</span><span class="p">,</span>
        <span class="p">}:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Run is already in terminal state </span><span class="si">{</span><span class="n">initial_state</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Only allow departure from a happily completed state if the result is not</span>
        <span class="c1"># persisted and the a rerun is being proposed</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">initial_state</span><span class="o">.</span><span class="n">is_completed</span><span class="p">()</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">is_final</span><span class="p">()</span>
            <span class="ow">and</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">data</span>
            <span class="ow">and</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;unpersisted&quot;</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Run is already COMPLETED.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Do not allows runs to be rescheduled without a deployment</span>
        <span class="k">if</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">is_scheduled</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">deployment_id</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span>
                <span class="s2">&quot;Cannot reschedule a run without an associated deployment.&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">is_final</span><span class="p">():</span>
            <span class="c1"># Reset pause metadata when leaving a terminal state</span>
            <span class="n">api_version</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;api-version&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">api_version</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">api_version</span> <span class="o">&gt;=</span> <span class="n">Version</span><span class="p">(</span><span class="s2">&quot;0.8.4&quot;</span><span class="p">):</span>
                <span class="n">updated_policy</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
                <span class="n">updated_policy</span><span class="p">[</span><span class="s2">&quot;resuming&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">updated_policy</span><span class="p">[</span><span class="s2">&quot;pause_keys&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
                <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">FlowRunPolicy</span><span class="p">(</span><span class="o">**</span><span class="n">updated_policy</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">FlowRunPolicy</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">original_flow_policy</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.PreventPendingTransitions" class="doc doc-heading">
          <code>PreventPendingTransitions</code>


<a href="#prefect.server.orchestration.core_policy.PreventPendingTransitions" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Prevents transitions to PENDING.</p>
<p>This rule is only used for flow runs.</p>
<p>This is intended to prevent race conditions during duplicate submissions of runs.
Before a run is submitted to its execution environment, it should be placed in a
PENDING state. If two workers attempt to submit the same run, one of them should
encounter a PENDING -&gt; PENDING transition and abort orchestration of the run.</p>
<p>Similarly, if the execution environment starts quickly the run may be in a RUNNING
state when the second worker attempts the PENDING transition. We deny these state
changes as well to prevent duplicate submission. If a run has transitioned to a
RUNNING state a worker should not attempt to submit it again unless it has moved
into a terminal state.</p>
<p>CANCELLING and CANCELLED runs should not be allowed to transition to PENDING.
For re-runs of deployed runs, they should transition to SCHEDULED first.
For re-runs of ad-hoc runs, they should transition directly to RUNNING.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PreventPendingTransitions</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prevents transitions to PENDING.</span>

<span class="sd">    This rule is only used for flow runs.</span>

<span class="sd">    This is intended to prevent race conditions during duplicate submissions of runs.</span>
<span class="sd">    Before a run is submitted to its execution environment, it should be placed in a</span>
<span class="sd">    PENDING state. If two workers attempt to submit the same run, one of them should</span>
<span class="sd">    encounter a PENDING -&gt; PENDING transition and abort orchestration of the run.</span>

<span class="sd">    Similarly, if the execution environment starts quickly the run may be in a RUNNING</span>
<span class="sd">    state when the second worker attempts the PENDING transition. We deny these state</span>
<span class="sd">    changes as well to prevent duplicate submission. If a run has transitioned to a</span>
<span class="sd">    RUNNING state a worker should not attempt to submit it again unless it has moved</span>
<span class="sd">    into a terminal state.</span>

<span class="sd">    CANCELLING and CANCELLED runs should not be allowed to transition to PENDING.</span>
<span class="sd">    For re-runs of deployed runs, they should transition to SCHEDULED first.</span>
<span class="sd">    For re-runs of ad-hoc runs, they should transition directly to RUNNING.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">StateType</span><span class="o">.</span><span class="n">PENDING</span><span class="p">,</span>
        <span class="n">StateType</span><span class="o">.</span><span class="n">CANCELLING</span><span class="p">,</span>
        <span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">,</span>
        <span class="n">StateType</span><span class="o">.</span><span class="n">CANCELLED</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">PENDING</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span>
            <span class="n">reason</span><span class="o">=</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;This run is in a </span><span class="si">{</span><span class="n">initial_state</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> state and cannot&quot;</span>
                <span class="s2">&quot; transition to a PENDING state.&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.PreventRunningTasksFromStoppedFlows" class="doc doc-heading">
          <code>PreventRunningTasksFromStoppedFlows</code>


<a href="#prefect.server.orchestration.core_policy.PreventRunningTasksFromStoppedFlows" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Prevents running tasks from stopped flows.</p>
<p>A running state implies execution, but also the converse. This rule ensures that a
flow's tasks cannot be run unless the flow is also running.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PreventRunningTasksFromStoppedFlows</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prevents running tasks from stopped flows.</span>

<span class="sd">    A running state implies execution, but also the converse. This rule ensures that a</span>
<span class="sd">    flow&#39;s tasks cannot be run unless the flow is also running.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">flow_run</span> <span class="o">=</span> <span class="k">await</span> <span class="n">context</span><span class="o">.</span><span class="n">flow_run</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">flow_run</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span>
                    <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;The enclosing flow must be running to begin task execution.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">StateType</span><span class="o">.</span><span class="n">PAUSED</span><span class="p">:</span>
                <span class="c1"># Use the flow run&#39;s Paused state details to preserve data like</span>
                <span class="c1"># timeouts.</span>
                <span class="n">paused_state</span> <span class="o">=</span> <span class="n">states</span><span class="o">.</span><span class="n">Paused</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;NotReady&quot;</span><span class="p">,</span>
                    <span class="n">pause_expiration_time</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">pause_timeout</span><span class="p">,</span>
                    <span class="n">reschedule</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">pause_reschedule</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                    <span class="n">state</span><span class="o">=</span><span class="n">paused_state</span><span class="p">,</span>
                    <span class="n">reason</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;The flow is paused, new tasks can execute after resuming flow&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot; run: </span><span class="si">{</span><span class="n">flow_run</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">:</span>
                <span class="c1"># task runners should abort task run execution</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">abort_transition</span><span class="p">(</span>
                    <span class="n">reason</span><span class="o">=</span><span class="p">(</span>
                        <span class="s2">&quot;The enclosing flow must be running to begin task execution.&quot;</span>
                    <span class="p">),</span>
                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.EnforceCancellingToCancelledTransition" class="doc doc-heading">
          <code>EnforceCancellingToCancelledTransition</code>


<a href="#prefect.server.orchestration.core_policy.EnforceCancellingToCancelledTransition" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Rejects transitions from Cancelling to any terminal state except for Cancelled.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EnforceCancellingToCancelledTransition</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rejects transitions from Cancelling to any terminal state except for Cancelled.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">{</span><span class="n">StateType</span><span class="o">.</span><span class="n">CANCELLED</span><span class="p">,</span> <span class="n">StateType</span><span class="o">.</span><span class="n">CANCELLING</span><span class="p">}</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span> <span class="o">-</span> <span class="p">{</span><span class="n">StateType</span><span class="o">.</span><span class="n">CANCELLED</span><span class="p">}</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">TaskOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
            <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">reason</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;Cannot transition flows that are cancelling to a state other &quot;</span>
                <span class="s2">&quot;than Cancelled.&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.BypassCancellingFlowRunsWithNoInfra" class="doc doc-heading">
          <code>BypassCancellingFlowRunsWithNoInfra</code>


<a href="#prefect.server.orchestration.core_policy.BypassCancellingFlowRunsWithNoInfra" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Rejects transitions from Scheduled to Cancelling, and instead sets the state to Cancelled,
if the flow run has no associated infrastructure process ID. Also Rejects transitions from
Paused to Cancelling if the Paused state's details indicates the flow run has been suspended,
exiting the flow and tearing down infra.</p>
<p>The <code>Cancelling</code> state is used to clean up infrastructure. If there is not infrastructure
to clean up, we can transition directly to <code>Cancelled</code>. Runs that are <code>Resuming</code> are in a
<code>Scheduled</code> state that were previously <code>Suspended</code> and do not yet have infrastructure.</p>
<p>Runs that are <code>AwaitingRetry</code> are a <code>Scheduled</code> state that may have associated infrastructure.</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BypassCancellingFlowRunsWithNoInfra</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Rejects transitions from Scheduled to Cancelling, and instead sets the state to Cancelled,</span>
<span class="sd">    if the flow run has no associated infrastructure process ID. Also Rejects transitions from</span>
<span class="sd">    Paused to Cancelling if the Paused state&#39;s details indicates the flow run has been suspended,</span>
<span class="sd">    exiting the flow and tearing down infra.</span>

<span class="sd">    The `Cancelling` state is used to clean up infrastructure. If there is not infrastructure</span>
<span class="sd">    to clean up, we can transition directly to `Cancelled`. Runs that are `Resuming` are in a</span>
<span class="sd">    `Scheduled` state that were previously `Suspended` and do not yet have infrastructure.</span>

<span class="sd">    Runs that are `AwaitingRetry` are a `Scheduled` state that may have associated infrastructure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">{</span><span class="n">StateType</span><span class="o">.</span><span class="n">SCHEDULED</span><span class="p">,</span> <span class="n">StateType</span><span class="o">.</span><span class="n">PAUSED</span><span class="p">}</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">{</span><span class="n">StateType</span><span class="o">.</span><span class="n">CANCELLING</span><span class="p">}</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">FlowOrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">initial_state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="o">.</span><span class="n">SCHEDULED</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">infrastructure_pid</span>
            <span class="ow">or</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Resuming&quot;</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                <span class="n">state</span><span class="o">=</span><span class="n">states</span><span class="o">.</span><span class="n">Cancelled</span><span class="p">(),</span>
                <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Scheduled flow run has no infrastructure to terminate.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">initial_state</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="o">.</span><span class="n">PAUSED</span>
            <span class="ow">and</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">state_details</span><span class="o">.</span><span class="n">pause_reschedule</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                <span class="n">state</span><span class="o">=</span><span class="n">states</span><span class="o">.</span><span class="n">Cancelled</span><span class="p">(),</span>
                <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Suspended flow run has no infrastructure to terminate.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.core_policy.PreventDuplicateTransitions" class="doc doc-heading">
          <code>PreventDuplicateTransitions</code>


<a href="#prefect.server.orchestration.core_policy.PreventDuplicateTransitions" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.BaseOrchestrationRule" href="../rules/#prefect.server.orchestration.rules.BaseOrchestrationRule">BaseOrchestrationRule</a></code></p>

  
      <p>Prevent duplicate transitions from being made right after one another.</p>
<p>This rule allows for clients to set an optional transition_id on a state. If the
run's next transition has the same transition_id, the transition will be
rejected and the existing state will be returned.</p>
<p>This allows for clients to make state transition requests without worrying about
the following case:
- A client making a state transition request
- The server accepts transition and commits the transition
- The client is unable to receive the response and retries the request</p>

            <details class="quote">
              <summary>Source code in <code>prefect/server/orchestration/core_policy.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PreventDuplicateTransitions</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prevent duplicate transitions from being made right after one another.</span>

<span class="sd">    This rule allows for clients to set an optional transition_id on a state. If the</span>
<span class="sd">    run&#39;s next transition has the same transition_id, the transition will be</span>
<span class="sd">    rejected and the existing state will be returned.</span>

<span class="sd">    This allows for clients to make state transition requests without worrying about</span>
<span class="sd">    the following case:</span>
<span class="sd">    - A client making a state transition request</span>
<span class="sd">    - The server accepts transition and commits the transition</span>
<span class="sd">    - The client is unable to receive the response and retries the request</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">initial_state</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="n">proposed_state</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="n">initial_state</span><span class="o">.</span><span class="n">state_details</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="n">proposed_state</span><span class="o">.</span><span class="n">state_details</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="k">return</span>

        <span class="n">initial_transition_id</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="n">initial_state</span><span class="o">.</span><span class="n">state_details</span><span class="p">,</span> <span class="s2">&quot;transition_id&quot;</span><span class="p">,</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">proposed_transition_id</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="n">proposed_state</span><span class="o">.</span><span class="n">state_details</span><span class="p">,</span> <span class="s2">&quot;transition_id&quot;</span><span class="p">,</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">initial_transition_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">proposed_transition_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="n">initial_transition_id</span> <span class="o">==</span> <span class="n">proposed_transition_id</span>
        <span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_transition</span><span class="p">(</span>
                <span class="c1"># state=None will return the initial (current) state</span>
                <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;This run has already made this state transition.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>




  </div>

  </div>

</div>









  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thank you for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thank you for your feedback! Feel free to <a href="https://github.com/PrefectHQ/prefect/issues/new?assignees=&amp;labels=docs%2Cstatus%3Atriage&amp;projects=&amp;template=4_docs_change.yaml" target="_blank" rel="noopener"> open an issue </a> with more detail.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["announce.dismiss", "content.action.edit", "content.code.copy", "navigation.tabs.sticky", "search.suggest", "search.highlight", "navigation.path", "navigation.indexes", "content.tabs.link"], "search": "../../../../assets/javascripts/workers/search.1e90e0fb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.1135ae9f.min.js"></script>
      
        <script src="../../../../js/custom.js"></script>
      
        <script src="../../../../js/termynal.js"></script>
      
    
  </body>
</html>