
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.prefect.io/latest/api-ref/server/orchestration/rules/">
      
      
        <link rel="prev" href="../../models/saved_searches/">
      
      
        <link rel="next" href="../policies/">
      
      
        
      
      
      <link rel="icon" href="../../../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.7+insiders-4.32.6">
    
    
      
        <title>server.orchestration.rules - Prefect Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.dc5b59cc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.6932e648.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/theme.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/admonitions.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/api_ref.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/rest_ref.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/syntax_highlights.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/termynal.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    

      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-3M31G9B0QJ"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-3M31G9B0QJ",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-3M31G9B0QJ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    

<script>
  !function () {
    var analytics = window.analytics = window.analytics || []; if (!analytics.initialize) if (analytics.invoked) window.console && console.error && console.error("Segment snippet included twice."); else {
      analytics.invoked = !0; analytics.methods = ["trackSubmit", "trackClick", "trackLink", "trackForm", "pageview", "identify", "reset", "group", "track", "ready", "alias", "debug", "page", "once", "off", "on", "addSourceMiddleware", "addIntegrationMiddleware", "setAnonymousId", "addDestinationMiddleware"]; analytics.factory = function (e) { return function () { var t = Array.prototype.slice.call(arguments); t.unshift(e); analytics.push(t); return analytics } }; for (var e = 0; e < analytics.methods.length; e++) { var key = analytics.methods[e]; analytics[key] = analytics.factory(key) } analytics.load = function (key, e) { var t = document.createElement("script"); t.type = "text/javascript"; t.async = !0; t.src = "https://cdn.segment.com/analytics.js/v1/" + key + "/analytics.min.js"; var n = document.getElementsByTagName("script")[0]; n.parentNode.insertBefore(t, n); analytics._loadOptions = e }; analytics._writeKey = "xDLAoTXsNYpC4Y6JucKnJ8W1MYBuyAbD";; analytics.SNIPPET_VERSION = "4.15.3";
      analytics.load("xDLAoTXsNYpC4Y6JucKnJ8W1MYBuyAbD");
      analytics.page();
    }
  }();
</script>

    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="server.orchestration.rules - Prefect Docs" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://docs.prefect.io/latest/assets/images/social/api-ref/server/orchestration/rules.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://docs.prefect.io/latest/api-ref/server/orchestration/rules/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="server.orchestration.rules - Prefect Docs" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://docs.prefect.io/latest/assets/images/social/api-ref/server/orchestration/rules.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prefect.server.orchestration.rules" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
              </button>
            
            
<div style="color: white;">
  <a href="https://github.com/PrefectHQ/prefect/blob/main/RELEASE-NOTES.md#release-2105" style="color: #07e798;">
    <strong>Prefect 2.10.5 is here!</strong>
  </a> With workers for each major cloud provider, automations for building deployments, and
  <a href="https://github.com/PrefectHQ/prefect/blob/main/RELEASE-NOTES.md#release-2105" style="color: #07e798;">
    <strong>more!</strong>
  </a>
</div>

<!-- <div style="color: white;">
    Looking for the 
    <a href="http://docs-v1.prefect.io/" style="color: #07e798;">
      <strong>Prefect 1 docs</strong>
    </a> for Prefect 1 Core and Server? Find them at: 
    <a href="http://docs-v1.prefect.io/" style="color: #07e798;">
      <strong>http://docs-v1.prefect.io/</strong>
    </a>
  </div> -->

          </div>
          
            <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're viewing the docs for Prefect unreleased.
  <a href="../../../../.."> 
    <strong>Click here to view the latest docs.</strong>
  </a>

  <script type="text/javascript">
    // extract the version from the URL
    var version = window.location.pathname.split('/')[1];
    console.log("version is latest!")
    // check if the version is 'latest'
    var showVersionBanner = version !== 'latest';
    
    // hide the announcement bar if we're not showing the latest version of the docs
    // wait until dom is loaded
    document.addEventListener("DOMContentLoaded", function(event) {
      if (showVersionBanner) {
        document.querySelector('[data-md-component="announce"]').setAttribute('hidden', '');
      }
    });
  </script>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Prefect Docs" class="md-header__button md-logo" aria-label="Prefect Docs" data-md-component="logo">
      
  <img src="../../../../img/logos/prefect-logo-gradient-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Prefect Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              server.orchestration.rules
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
      </form>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/PrefectHQ/prefect" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Prefect Docs" class="md-nav__button md-logo" aria-label="Prefect Docs" data-md-component="logo">
      
  <img src="../../../../img/logos/prefect-logo-gradient-white.svg" alt="logo">

    </a>
    Prefect Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PrefectHQ/prefect" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../.." class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m23 7.5-6.47-.54L14 1l-2.53 5.96L5 7.5l4.9 4.27-1.46 6.33L14 14.74l5.56 3.36-1.47-6.33L23 7.5m-6.86 4.73.4 1.71-1.51-.91-1.03-.62-1.03.62-1.51.91.39-1.71.28-1.18-.91-.79L9.88 9.1l1.76-.15 1.2-.1.47-1.11.69-1.62.69 1.62.47 1.11 1.2.1 1.75.15-1.33 1.16-.92.79.28 1.18M1.16 12c-.299-.5-.171-1.11.29-1.41l2.73-1.8 1.57 1.36-3.2 2.11c-.17.11-.36.17-.55.17-.32 0-.64-.16-.84-.43m.29 8.16 5.86-3.85L7 17.76l-.34 1.37-4.11 2.71c-.17.11-.36.16-.55.16-.32 0-.64-.16-.84-.45a1.013 1.013 0 0 1 .29-1.39m5.87-8.66.92.81-.27 1.19-5.42 3.55c-.17.11-.36.16-.55.16-.32 0-.64-.15-.84-.45a1 1 0 0 1 .29-1.38l5.87-3.88Z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_1">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/cloud-quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cloud Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../tutorials/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 17c-.14 0-.26 0-.39.04L17.5 13.8c.45-.45.75-1.09.75-1.8a2.5 2.5 0 0 0-2.5-2.5c-.14 0-.25 0-.4.04L13.74 6.3c.47-.46.76-1.09.76-1.8a2.5 2.5 0 0 0-5 0c0 .7.29 1.34.76 1.79L8.65 9.54c-.15-.04-.26-.04-.4-.04a2.5 2.5 0 0 0-2.5 2.5c0 .71.29 1.34.75 1.79l-1.61 3.25C4.76 17 4.64 17 4.5 17a2.5 2.5 0 0 0 0 5A2.5 2.5 0 0 0 7 19.5c0-.7-.29-1.34-.76-1.79l1.62-3.25c.14.04.26.04.39.04s.25 0 .38-.04l1.63 3.25c-.47.45-.76 1.09-.76 1.79a2.5 2.5 0 0 0 5 0A2.5 2.5 0 0 0 12 17c-.13 0-.26 0-.39.04L10 13.8c.45-.45.75-1.09.75-1.8 0-.7-.29-1.33-.75-1.79l1.61-3.25c.13.04.26.04.39.04s.26 0 .39-.04L14 10.21a2.5 2.5 0 0 0 1.75 4.29c.13 0 .25 0 .38-.04l1.63 3.25c-.47.45-.76 1.09-.76 1.79a2.5 2.5 0 0 0 5 0 2.5 2.5 0 0 0-2.5-2.5m-15 3.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m8.5-1c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1M7.25 12c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1M11 4.5c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1m3.75 7.5c0-.55.45-1 1-1s1 .45 1 1-.45 1-1 1-1-.45-1-1m4.75 8.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1Z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/first-steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Flows & Tasks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/flow-task-config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/execution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/orchestration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Orchestration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Projects
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Storage & Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/developing-a-new-worker-type/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Developing a New Worker Type
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../concepts/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21.33 12.91c.09 1.55-.62 3.04-1.89 3.95l.77 1.49c.23.45.26.98.06 1.45-.19.47-.58.84-1.06 1l-.79.25a1.687 1.687 0 0 1-1.86-.55L14.44 18c-.89-.15-1.73-.53-2.44-1.1-.5.15-1 .23-1.5.23-.88 0-1.76-.27-2.5-.79-.53.16-1.07.23-1.62.22-.79.01-1.57-.15-2.3-.45a4.105 4.105 0 0 1-2.43-3.61c-.08-.72.04-1.45.35-2.11-.29-.75-.32-1.57-.07-2.33C2.3 7.11 3 6.32 3.87 5.82c.58-1.69 2.21-2.82 4-2.7 1.6-1.5 4.05-1.66 5.83-.37.42-.11.86-.17 1.3-.17 1.36-.03 2.65.57 3.5 1.64 2.04.53 3.5 2.35 3.58 4.47.05 1.11-.25 2.2-.86 3.13.07.36.11.72.11 1.09m-5-1.41c.57.07 1.02.5 1.02 1.07a1 1 0 0 1-1 1h-.63c-.32.9-.88 1.69-1.62 2.29.25.09.51.14.77.21 5.13-.07 4.53-3.2 4.53-3.25a2.592 2.592 0 0 0-2.69-2.49 1 1 0 0 1-1-1 1 1 0 0 1 1-1c1.23.03 2.41.49 3.33 1.3.05-.29.08-.59.08-.89-.06-1.24-.62-2.32-2.87-2.53-1.25-2.96-4.4-1.32-4.4-.4-.03.23.21.72.25.75a1 1 0 0 1 1 1c0 .55-.45 1-1 1-.53-.02-1.03-.22-1.43-.56-.48.31-1.03.5-1.6.56-.57.05-1.04-.35-1.07-.9a.968.968 0 0 1 .88-1.1c.16-.02.94-.14.94-.77 0-.66.25-1.29.68-1.79-.92-.25-1.91.08-2.91 1.29C6.75 5 6 5.25 5.45 7.2 4.5 7.67 4 8 3.78 9c1.08-.22 2.19-.13 3.22.25.5.19.78.75.59 1.29-.19.52-.77.78-1.29.59-.73-.32-1.55-.34-2.3-.06-.32.27-.32.83-.32 1.27 0 .74.37 1.43 1 1.83.53.27 1.12.41 1.71.4-.15-.26-.28-.53-.39-.81a1.038 1.038 0 0 1 1.96-.68c.4 1.14 1.42 1.92 2.62 2.05 1.37-.07 2.59-.88 3.19-2.13.23-1.38 1.34-1.5 2.56-1.5m2 7.47-.62-1.3-.71.16 1 1.25.33-.11m-4.65-8.61a1 1 0 0 0-.91-1.03c-.71-.04-1.4.2-1.93.67-.57.58-.87 1.38-.84 2.19a1 1 0 0 0 1 1c.57 0 1-.45 1-1 0-.27.07-.54.23-.76.12-.1.27-.15.43-.15.55.03 1.02-.38 1.02-.92Z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_3">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Develop
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Develop
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Tasks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Results
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/artifacts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Artifacts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    States
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/blocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Blocks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/task-runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Task Runners
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/runtime-context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Runtime Context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Profiles & Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Deploy
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Deploy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Projects
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/work-pools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Work Pools, Workers & Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/storage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Filesystems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/infrastructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/schedules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Schedules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../cloud/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 20q-2.28 0-3.89-1.57Q1 16.85 1 14.58q0-1.95 1.17-3.48 1.18-1.53 3.08-1.95.63-2.3 2.5-3.72Q9.63 4 12 4q2.93 0 4.96 2.04Q19 8.07 19 11q1.73.2 2.86 1.5 1.14 1.28 1.14 3 0 1.88-1.31 3.19T18.5 20m-12-2h12q1.05 0 1.77-.73.73-.72.73-1.77t-.73-1.77Q19.55 13 18.5 13H17v-2q0-2.07-1.46-3.54Q14.08 6 12 6 9.93 6 8.46 7.46 7 8.93 7 11h-.5q-1.45 0-2.47 1.03Q3 13.05 3 14.5q0 1.45 1.03 2.5 1.02 1 2.47 1m5.5-6Z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Cloud
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_4">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cloud
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/cloud-quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Cloud Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/workspaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Workspaces
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/organizations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Organizations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../cloud/users/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    
  
    Users
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_4_5">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Users
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/roles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Roles (RBAC)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/api-keys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    API Keys
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/service-accounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Service Accounts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/sso/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Single Sign-on (SSO)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/users/audit-log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Audit Log
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/automations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Automations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/rate-limits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    API Rate Limits
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cloud/connecting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Connecting & Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../host/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.75 6.5a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5ZM6 7.25a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 6 7.25Zm4 9a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75Zm-3.25-.75a.75.75 0 0 0 0 1.5h.5a.75.75 0 0 0 0-1.5h-.5Z"/><path d="M3.25 2h17.5c.966 0 1.75.784 1.75 1.75v7c0 .372-.116.716-.314 1 .198.284.314.628.314 1v7a1.75 1.75 0 0 1-1.75 1.75H3.25a1.75 1.75 0 0 1-1.75-1.75v-7c0-.358.109-.707.314-1a1.741 1.741 0 0 1-.314-1v-7C1.5 2.784 2.284 2 3.25 2Zm0 10.5a.25.25 0 0 0-.25.25v7c0 .138.112.25.25.25h17.5a.25.25 0 0 0 .25-.25v-7a.25.25 0 0 0-.25-.25Zm0-1.5h17.5a.25.25 0 0 0 .25-.25v-7a.25.25 0 0 0-.25-.25H3.25a.25.25 0 0 0-.25.25v7c0 .138.112.25.25.25Z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Host
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Host
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../guides/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_6">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/dask-ray-task-runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Dask & Ray
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Deployment
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Deployment
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/deployment/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/deployment/aci/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Azure Container Instance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../recipes/recipes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Recipes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../guides/migration-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Migration Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../integrations/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4 8H2.5a1 1 0 0 0-1 1v5.25a.75.75 0 0 1-1.5 0V9a2.5 2.5 0 0 1 2.5-2.5H4V5.133a1.75 1.75 0 0 1 1.533-1.737l2.831-.353.76-.913c.332-.4.825-.63 1.344-.63h.782c.966 0 1.75.784 1.75 1.75V4h2.25a.75.75 0 0 1 0 1.5H13v4h2.25a.75.75 0 0 1 0 1.5H13v.75a1.75 1.75 0 0 1-1.75 1.75h-.782c-.519 0-1.012-.23-1.344-.63l-.761-.912-2.83-.354A1.75 1.75 0 0 1 4 9.867Zm6.276-4.91-.95 1.14a.753.753 0 0 1-.483.265l-3.124.39a.25.25 0 0 0-.219.248v4.734c0 .126.094.233.219.249l3.124.39a.752.752 0 0 1 .483.264l.95 1.14a.25.25 0 0 0 .192.09h.782a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-.782a.25.25 0 0 0-.192.09Z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_7">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Using Integrations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../integrations/contribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Contributing Integrations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M0 1.75A.75.75 0 0 1 .75 1h4.253c1.227 0 2.317.59 3 1.501A3.743 3.743 0 0 1 11.006 1h4.245a.75.75 0 0 1 .75.75v10.5a.75.75 0 0 1-.75.75h-4.507a2.25 2.25 0 0 0-1.591.659l-.622.621a.75.75 0 0 1-1.06 0l-.622-.621A2.25 2.25 0 0 0 5.258 13H.75a.75.75 0 0 1-.75-.75Zm7.251 10.324.004-5.073-.002-2.253A2.25 2.25 0 0 0 5.003 2.5H1.5v9h3.757a3.75 3.75 0 0 1 1.994.574ZM8.755 4.75l-.004 7.322a3.752 3.752 0 0 1 1.992-.572H14.5v-9h-3.495a2.25 2.25 0 0 0-2.25 2.25Z"/></svg>
  
  <span class="md-ellipsis">
    
  
    API References
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_8">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    API References
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          <label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Python SDK API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Python SDK API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/artifacts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.artifacts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/context/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.filesystems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/futures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.futures
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/infrastructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_12" >
        
          <label class="md-nav__link" for="__nav_8_2_12" id="__nav_8_2_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.projects
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.projects
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/projects/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.projects.base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/projects/steps/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.projects.steps.core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/projects/steps/pull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.projects.steps.pull
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_13" >
        
          <label class="md-nav__link" for="__nav_8_2_13" id="__nav_8_2_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    prefect.runtime
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    prefect.runtime
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runtime/flow_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.runtime.flow_run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runtime/deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.runtime.deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/runtime/task_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.runtime.task_run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/serializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.serializers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.settings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/task-runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.task_runners
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.tasks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_19" >
        
          <label class="md-nav__link" for="__nav_8_2_19" id="__nav_8_2_19_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Blocks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_19">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blocks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.blocks.core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.blocks.kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/notifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.blocks.notifications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/system/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.blocks.system
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/blocks/webhook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.blocks.webhook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_20" >
        
          <label class="md-nav__link" for="__nav_8_2_20" id="__nav_8_2_20_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Client
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_20_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_20">
            <span class="md-nav__icon md-icon"></span>
            
  
    Client
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.client.base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.client.cloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/orchestration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.client.orchestration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.client.schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/client/utilities/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.client.utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_21" >
        
          <label class="md-nav__link" for="__nav_8_2_21" id="__nav_8_2_21_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Command Line Interface
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_21_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_21">
            <span class="md-nav__icon md-icon"></span>
            
  
    Command Line Interface
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/cloud/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.cloud
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/concurrency_limit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.concurrency_limit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.dev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/profile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.profile
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.project
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/work_queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.work_queue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/root/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.root
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/flow_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.flow_run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/cli/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.cli.server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_22" >
        
          <label class="md-nav__link" for="__nav_8_2_22" id="__nav_8_2_22_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_22">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utilities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.utilities.annotations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/asyncutils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.utilities.asyncutils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/processutils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.utilities.processutils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/callables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.utilities.callables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/collections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.utilities.collections
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/filesystem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.utilities.filesystem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/utilities/hashing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.utilities.hashing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2_23" >
        
          <label class="md-nav__link" for="__nav_8_2_23" id="__nav_8_2_23_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Workers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_2_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2_23">
            <span class="md-nav__icon md-icon"></span>
            
  
    Workers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/workers/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.workers.base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../prefect/workers/process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    prefect.workers.process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3" checked>
        
          <label class="md-nav__link" for="__nav_8_3" id="__nav_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Server API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Server API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_1" >
        
          <label class="md-nav__link" for="__nav_8_3_1" id="__nav_8_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/admin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.admin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.dependencies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/flow_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.flow_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/flow_run_states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.flow_run_states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/run_history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.run_history
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/saved_searches/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.saved_searches
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/task_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.task_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/task_run_states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.api.task_run_states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_2" >
        
          <label class="md-nav__link" for="__nav_8_3_2" id="__nav_8_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../models/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.flows
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../models/flow_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.flow_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../models/flow_run_states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.flow_run_states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../models/task_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.task_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../models/task_run_states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.task_run_states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../models/deployments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../models/saved_searches/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.models.saved_searches
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_3" checked>
        
          <label class="md-nav__link" for="__nav_8_3_3" id="__nav_8_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Orchestration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Orchestration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    
  
    server.orchestration.rules
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    
  
    server.orchestration.rules
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext" class="md-nav__link">
    <span class="md-ellipsis">
      
        OrchestrationContext
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OrchestrationContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.initial_state_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        initial_state_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.proposed_state_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        proposed_state_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.validated_state_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        validated_state_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.safe_copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        safe_copy()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.entry_context" class="md-nav__link">
    <span class="md-ellipsis">
      
        entry_context()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.exit_context" class="md-nav__link">
    <span class="md-ellipsis">
      
        exit_context()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.FlowOrchestrationContext" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowOrchestrationContext
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FlowOrchestrationContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.FlowOrchestrationContext.run_settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_settings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.FlowOrchestrationContext.validate_proposed_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_proposed_state()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.FlowOrchestrationContext.safe_copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        safe_copy()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.TaskOrchestrationContext" class="md-nav__link">
    <span class="md-ellipsis">
      
        TaskOrchestrationContext
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TaskOrchestrationContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.TaskOrchestrationContext.run_settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_settings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.TaskOrchestrationContext.validate_proposed_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_proposed_state()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.TaskOrchestrationContext.safe_copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        safe_copy()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseOrchestrationRule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseOrchestrationRule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.before_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        before_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.after_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        cleanup()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.invalid" class="md-nav__link">
    <span class="md-ellipsis">
      
        invalid()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.fizzled" class="md-nav__link">
    <span class="md-ellipsis">
      
        fizzled()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.invalid_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        invalid_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.reject_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        reject_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.delay_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        delay_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.abort_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        abort_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.rename_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename_state()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.update_context_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_context_parameters()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseUniversalTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseUniversalTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform.before_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        before_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform.after_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform.nullified_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        nullified_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform.exception_in_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        exception_in_transition()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../policies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.orchestration.policies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../core_policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.orchestration.core_policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../global_policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.orchestration.global_policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_4" >
        
          <label class="md-nav__link" for="__nav_8_3_4" id="__nav_8_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Schemas
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Schemas
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.actions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.filters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/responses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.responses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/schedules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.schedules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/sorting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.sorting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../schemas/states/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.schemas.states
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_5" >
        
          <label class="md-nav__link" for="__nav_8_3_5" id="__nav_8_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../services/late_runs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.services.late_runs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../services/loop_service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.services.loop_service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../services/scheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.services.scheduler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_3_6" >
        
          <label class="md-nav__link" for="__nav_8_3_6" id="__nav_8_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utilities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.utilities.database
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.utilities.schemas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    server.utilities.server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_4" >
        
          <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    
  
    REST API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    REST API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../rest-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Prefect REST API Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../rest-api-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Prefect REST API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../community/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M2 5.5a3.5 3.5 0 1 1 5.898 2.549 5.508 5.508 0 0 1 3.034 4.084.75.75 0 1 1-1.482.235 4 4 0 0 0-7.9 0 .75.75 0 0 1-1.482-.236A5.507 5.507 0 0 1 3.102 8.05 3.493 3.493 0 0 1 2 5.5ZM11 4a3.001 3.001 0 0 1 2.22 5.018 5.01 5.01 0 0 1 2.56 3.012.749.749 0 0 1-.885.954.752.752 0 0 1-.549-.514 3.507 3.507 0 0 0-2.522-2.372.75.75 0 0 1-.574-.73v-.352a.75.75 0 0 1 .416-.672A1.5 1.5 0 0 0 11 5.5.75.75 0 0 1 11 4Zm-5.5-.5a2 2 0 1 0-.001 3.999A2 2 0 0 0 5.5 3.5Z"/></svg>
  
  <span class="md-ellipsis">
    
  
    Community
  

    
  </span>
  
  

            </a>
            
              <label class="md-nav__link " for="__nav_9">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Community
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/style/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Style
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Versioning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/common-mistakes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext" class="md-nav__link">
    <span class="md-ellipsis">
      
        OrchestrationContext
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OrchestrationContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.initial_state_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        initial_state_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.proposed_state_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        proposed_state_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.validated_state_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        validated_state_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.safe_copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        safe_copy()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.entry_context" class="md-nav__link">
    <span class="md-ellipsis">
      
        entry_context()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.OrchestrationContext.exit_context" class="md-nav__link">
    <span class="md-ellipsis">
      
        exit_context()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.FlowOrchestrationContext" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowOrchestrationContext
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FlowOrchestrationContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.FlowOrchestrationContext.run_settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_settings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.FlowOrchestrationContext.validate_proposed_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_proposed_state()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.FlowOrchestrationContext.safe_copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        safe_copy()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.TaskOrchestrationContext" class="md-nav__link">
    <span class="md-ellipsis">
      
        TaskOrchestrationContext
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TaskOrchestrationContext">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.TaskOrchestrationContext.run_settings" class="md-nav__link">
    <span class="md-ellipsis">
      
        run_settings
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.TaskOrchestrationContext.validate_proposed_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_proposed_state()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.TaskOrchestrationContext.safe_copy" class="md-nav__link">
    <span class="md-ellipsis">
      
        safe_copy()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseOrchestrationRule
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseOrchestrationRule">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.before_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        before_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.after_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.cleanup" class="md-nav__link">
    <span class="md-ellipsis">
      
        cleanup()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.invalid" class="md-nav__link">
    <span class="md-ellipsis">
      
        invalid()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.fizzled" class="md-nav__link">
    <span class="md-ellipsis">
      
        fizzled()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.invalid_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        invalid_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.reject_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        reject_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.delay_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        delay_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.abort_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        abort_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.rename_state" class="md-nav__link">
    <span class="md-ellipsis">
      
        rename_state()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.update_context_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_context_parameters()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform" class="md-nav__link">
    <span class="md-ellipsis">
      
        BaseUniversalTransform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BaseUniversalTransform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform.before_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        before_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform.after_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        after_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform.nullified_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        nullified_transition()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prefect.server.orchestration.rules.BaseUniversalTransform.exception_in_transition" class="md-nav__link">
    <span class="md-ellipsis">
      
        exception_in_transition()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                




  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
      
        
  
    
    
      <li class="md-path__item">
        <a href="../../../" class="md-path__link">
          
  <span class="md-ellipsis">
    API References
  </span>

        </a>
      </li>
    
  

      
        
  
    
    
      
  
    
    
      <li class="md-path__item">
        <a href="../../api/admin/" class="md-path__link">
          
  <span class="md-ellipsis">
    Server API
  </span>

        </a>
      </li>
    
  

    
  

      
        
  
    
    
      <li class="md-path__item">
        <a href="./" class="md-path__link">
          
  <span class="md-ellipsis">
    Orchestration
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/PrefectHQ/prefect/edit/main/docs/api-ref/server/orchestration/rules.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  


<div class="doc doc-object doc-module">



<h1 id="prefect.server.orchestration.rules" class="doc doc-heading">
          <code>prefect.server.orchestration.rules</code>


<a href="#prefect.server.orchestration.rules" class="headerlink" title="Permanent link">&para;</a></h1>

  <div class="doc doc-contents first">
  
      <p>Prefect's flow and task-run orchestration machinery.</p>
<p>This module contains all the core concepts necessary to implement Prefect's state
orchestration engine. These states correspond to intuitive descriptions of all the
points that a Prefect flow or task can observe executing user code and intervene, if
necessary. A detailed description of states can be found in our concept
<a href="/concepts/states">documentation</a>.</p>
<p>Prefect's orchestration engine operates under the assumption that no governed user code
will execute without first requesting Prefect REST API validate a change in state and record
metadata about the run. With all attempts to run user code being checked against a
Prefect instance, the Prefect REST API database becomes the unambiguous source of truth for managing
the execution of complex interacting workflows. Orchestration rules can be implemented
as discrete units of logic that operate against each state transition and can be fully
observable, extensible, and customizable -- all without needing to store or parse a
single line of user code.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.rules.OrchestrationContext" class="doc doc-heading">
        <code>OrchestrationContext</code>


<a href="#prefect.server.orchestration.rules.OrchestrationContext" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.utilities.schemas.PrefectBaseModel" href="../../utilities/schemas/#prefect.server.utilities.schemas.PrefectBaseModel">PrefectBaseModel</a></code></p>

  
      <p>A container for a state transition, governed by orchestration rules.</p>

<details class="note">
  <summary>Note</summary>
  <p>An <code>OrchestrationContext</code> should not be instantiated directly, instead
use the flow- or task- specific subclasses, <code>FlowOrchestrationContext</code> and
<code>TaskOrchestrationContext</code>.</p>
</details>      <p>When a flow- or task- run attempts to change state, Prefect REST API has an opportunity
to decide whether this transition can proceed. All the relevant information
associated with the state transition is stored in an <code>OrchestrationContext</code>,
which is subsequently governed by nested orchestration rules implemented using
the <code>BaseOrchestrationRule</code> ABC.</p>
<p><code>OrchestrationContext</code> introduces the concept of a state being <code>None</code> in the
context of an intended state transition. An initial state can be <code>None</code> if a run
is is attempting to set a state for the first time. The proposed state might be
<code>None</code> if a rule governing the transition determines that no state change
should occur at all and nothing is written to the database.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="sqlalchemy">sa</span>.<span title="sqlalchemy.orm">orm</span>.<span title="sa.orm.Session">Session</span>, <span title="sqlalchemy.ext.asyncio.AsyncSession">AsyncSession</span>]]</code>
          </td>
          <td><p>a SQLAlchemy database session</p></td>
        </tr>
        <tr>
          <td><code>initial_state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>the initial state of a run</p></td>
        </tr>
        <tr>
          <td><code>proposed_state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>the proposed state a run is transitioning into</p></td>
        </tr>
        <tr>
          <td><code>validated_state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>a proposed state that has committed to the database</p></td>
        </tr>
        <tr>
          <td><code>rule_signature</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td><p>a record of rules that have fired on entry into a
managed context, currently only used for debugging purposes</p></td>
        </tr>
        <tr>
          <td><code>finalization_signature</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td><p>a record of rules that have fired on exit from a
managed context, currently only used for debugging purposes</p></td>
        </tr>
        <tr>
          <td><code>response_status</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="prefect.server.schemas.responses.SetStateStatus" href="../../schemas/responses/#prefect.server.schemas.responses.SetStateStatus">SetStateStatus</a></code>
          </td>
          <td><p>a SetStateStatus object used to build the API response</p></td>
        </tr>
        <tr>
          <td><code>response_details</code></td>
          <td>
                <code><span title="prefect.server.schemas.responses.StateResponseDetails">StateResponseDetails</span></code>
          </td>
          <td><p>a StateResponseDetails object use to build the API response</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session</code></td>
          <td>
          </td>
          <td><p>a SQLAlchemy database session</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>initial_state</code></td>
          <td>
          </td>
          <td><p>the initial state of a run</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>proposed_state</code></td>
          <td>
          </td>
          <td><p>the proposed state a run is transitioning into</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OrchestrationContext</span><span class="p">(</span><span class="n">PrefectBaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A container for a state transition, governed by orchestration rules.</span>

<span class="sd">    Note:</span>
<span class="sd">        An `OrchestrationContext` should not be instantiated directly, instead</span>
<span class="sd">        use the flow- or task- specific subclasses, `FlowOrchestrationContext` and</span>
<span class="sd">        `TaskOrchestrationContext`.</span>

<span class="sd">    When a flow- or task- run attempts to change state, Prefect REST API has an opportunity</span>
<span class="sd">    to decide whether this transition can proceed. All the relevant information</span>
<span class="sd">    associated with the state transition is stored in an `OrchestrationContext`,</span>
<span class="sd">    which is subsequently governed by nested orchestration rules implemented using</span>
<span class="sd">    the `BaseOrchestrationRule` ABC.</span>

<span class="sd">    `OrchestrationContext` introduces the concept of a state being `None` in the</span>
<span class="sd">    context of an intended state transition. An initial state can be `None` if a run</span>
<span class="sd">    is is attempting to set a state for the first time. The proposed state might be</span>
<span class="sd">    `None` if a rule governing the transition determines that no state change</span>
<span class="sd">    should occur at all and nothing is written to the database.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        session: a SQLAlchemy database session</span>
<span class="sd">        initial_state: the initial state of a run</span>
<span class="sd">        proposed_state: the proposed state a run is transitioning into</span>
<span class="sd">        validated_state: a proposed state that has committed to the database</span>
<span class="sd">        rule_signature: a record of rules that have fired on entry into a</span>
<span class="sd">            managed context, currently only used for debugging purposes</span>
<span class="sd">        finalization_signature: a record of rules that have fired on exit from a</span>
<span class="sd">            managed context, currently only used for debugging purposes</span>
<span class="sd">        response_status: a SetStateStatus object used to build the API response</span>
<span class="sd">        response_details:a StateResponseDetails object use to build the API response</span>

<span class="sd">    Args:</span>
<span class="sd">        session: a SQLAlchemy database session</span>
<span class="sd">        initial_state: the initial state of a run</span>
<span class="sd">        proposed_state: the proposed state a run is transitioning into</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">arbitrary_types_allowed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">session</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">sa</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">Session</span><span class="p">,</span> <span class="n">AsyncSession</span><span class="p">]]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
    <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">]</span>
    <span class="n">rule_signature</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">finalization_signature</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">response_status</span><span class="p">:</span> <span class="n">SetStateStatus</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">SetStateStatus</span><span class="o">.</span><span class="n">ACCEPT</span><span class="p">)</span>
    <span class="n">response_details</span><span class="p">:</span> <span class="n">StateResponseDetails</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">StateAcceptDetails</span><span class="p">)</span>
    <span class="n">orchestration_error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">Exception</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">initial_state_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The state type of `self.initial_state` if it exists.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="o">.</span><span class="n">type</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">proposed_state_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The state type of `self.proposed_state` if it exists.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">type</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">validated_state_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The state type of `self.validated_state` if it exists.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span><span class="o">.</span><span class="n">type</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">safe_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a mostly-mutation-safe copy for use in orchestration rules.</span>

<span class="sd">        Orchestration rules govern state transitions using information stored in</span>
<span class="sd">        an `OrchestrationContext`. However, mutating objects stored on the context</span>
<span class="sd">        directly can have unintended side-effects. To guard against this,</span>
<span class="sd">        `self.safe_copy` can be used to pass information to orchestration rules</span>
<span class="sd">        without risking mutation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A mutation-safe copy of the `OrchestrationContext`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">safe_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">safe_copy</span><span class="o">.</span><span class="n">initial_state</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">safe_copy</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">safe_copy</span><span class="o">.</span><span class="n">validated_state</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>
        <span class="n">safe_copy</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">safe_copy</span>

    <span class="k">def</span> <span class="nf">entry_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A convenience method that generates input parameters for orchestration rules.</span>

<span class="sd">        An `OrchestrationContext` defines a state transition that is managed by</span>
<span class="sd">        orchestration rules which can fire hooks before a transition has been committed</span>
<span class="sd">        to the database. These hooks have a consistent interface which can be generated</span>
<span class="sd">        with this method.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">safe_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">safe_context</span><span class="o">.</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">safe_context</span><span class="o">.</span><span class="n">proposed_state</span><span class="p">,</span> <span class="n">safe_context</span>

    <span class="k">def</span> <span class="nf">exit_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A convenience method that generates input parameters for orchestration rules.</span>

<span class="sd">        An `OrchestrationContext` defines a state transition that is managed by</span>
<span class="sd">        orchestration rules which can fire hooks after a transition has been committed</span>
<span class="sd">        to the database. These hooks have a consistent interface which can be generated</span>
<span class="sd">        with this method.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">safe_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">safe_context</span><span class="o">.</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">safe_context</span><span class="o">.</span><span class="n">validated_state</span><span class="p">,</span> <span class="n">safe_context</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="prefect.server.orchestration.rules.OrchestrationContext.initial_state_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">initial_state_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.OrchestrationContext.initial_state_type" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The state type of <code>self.initial_state</code> if it exists.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="prefect.server.orchestration.rules.OrchestrationContext.proposed_state_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">proposed_state_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.OrchestrationContext.proposed_state_type" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The state type of <code>self.proposed_state</code> if it exists.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="prefect.server.orchestration.rules.OrchestrationContext.validated_state_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validated_state_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.OrchestrationContext.validated_state_type" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The state type of <code>self.validated_state</code> if it exists.</p>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.OrchestrationContext.safe_copy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">safe_copy</span></code>

<a href="#prefect.server.orchestration.rules.OrchestrationContext.safe_copy" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a mostly-mutation-safe copy for use in orchestration rules.</p>
<p>Orchestration rules govern state transitions using information stored in
an <code>OrchestrationContext</code>. However, mutating objects stored on the context
directly can have unintended side-effects. To guard against this,
<code>self.safe_copy</code> can be used to pass information to orchestration rules
without risking mutation.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>A mutation-safe copy of the <code>OrchestrationContext</code></p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">safe_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a mostly-mutation-safe copy for use in orchestration rules.</span>

<span class="sd">    Orchestration rules govern state transitions using information stored in</span>
<span class="sd">    an `OrchestrationContext`. However, mutating objects stored on the context</span>
<span class="sd">    directly can have unintended side-effects. To guard against this,</span>
<span class="sd">    `self.safe_copy` can be used to pass information to orchestration rules</span>
<span class="sd">    without risking mutation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A mutation-safe copy of the `OrchestrationContext`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">safe_copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">safe_copy</span><span class="o">.</span><span class="n">initial_state</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">safe_copy</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">safe_copy</span><span class="o">.</span><span class="n">validated_state</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="p">)</span>
    <span class="n">safe_copy</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">safe_copy</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.OrchestrationContext.entry_context" class="doc doc-heading">
<code class="highlight language-python"><span class="n">entry_context</span></code>

<a href="#prefect.server.orchestration.rules.OrchestrationContext.entry_context" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>A convenience method that generates input parameters for orchestration rules.</p>
<p>An <code>OrchestrationContext</code> defines a state transition that is managed by
orchestration rules which can fire hooks before a transition has been committed
to the database. These hooks have a consistent interface which can be generated
with this method.</p>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">entry_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A convenience method that generates input parameters for orchestration rules.</span>

<span class="sd">    An `OrchestrationContext` defines a state transition that is managed by</span>
<span class="sd">    orchestration rules which can fire hooks before a transition has been committed</span>
<span class="sd">    to the database. These hooks have a consistent interface which can be generated</span>
<span class="sd">    with this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">safe_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">safe_context</span><span class="o">.</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">safe_context</span><span class="o">.</span><span class="n">proposed_state</span><span class="p">,</span> <span class="n">safe_context</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.OrchestrationContext.exit_context" class="doc doc-heading">
<code class="highlight language-python"><span class="n">exit_context</span></code>

<a href="#prefect.server.orchestration.rules.OrchestrationContext.exit_context" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>A convenience method that generates input parameters for orchestration rules.</p>
<p>An <code>OrchestrationContext</code> defines a state transition that is managed by
orchestration rules which can fire hooks after a transition has been committed
to the database. These hooks have a consistent interface which can be generated
with this method.</p>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">exit_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A convenience method that generates input parameters for orchestration rules.</span>

<span class="sd">    An `OrchestrationContext` defines a state transition that is managed by</span>
<span class="sd">    orchestration rules which can fire hooks after a transition has been committed</span>
<span class="sd">    to the database. These hooks have a consistent interface which can be generated</span>
<span class="sd">    with this method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">safe_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">safe_context</span><span class="o">.</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">safe_context</span><span class="o">.</span><span class="n">validated_state</span><span class="p">,</span> <span class="n">safe_context</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.rules.FlowOrchestrationContext" class="doc doc-heading">
        <code>FlowOrchestrationContext</code>


<a href="#prefect.server.orchestration.rules.FlowOrchestrationContext" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.OrchestrationContext" href="#prefect.server.orchestration.rules.OrchestrationContext">OrchestrationContext</a></code></p>

  
      <p>A container for a flow run state transition, governed by orchestration rules.</p>
<p>When a flow- run attempts to change state, Prefect REST API has an opportunity
to decide whether this transition can proceed. All the relevant information
associated with the state transition is stored in an <code>OrchestrationContext</code>,
which is subsequently governed by nested orchestration rules implemented using
the <code>BaseOrchestrationRule</code> ABC.</p>
<p><code>FlowOrchestrationContext</code> introduces the concept of a state being <code>None</code> in the
context of an intended state transition. An initial state can be <code>None</code> if a run
is is attempting to set a state for the first time. The proposed state might be
<code>None</code> if a rule governing the transition determines that no state change
should occur at all and nothing is written to the database.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session</code></td>
          <td>
          </td>
          <td><p>a SQLAlchemy database session</p></td>
        </tr>
        <tr>
          <td><code>run</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>the flow run attempting to change state</p></td>
        </tr>
        <tr>
          <td><code>initial_state</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>the initial state of the run</p></td>
        </tr>
        <tr>
          <td><code>proposed_state</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>the proposed state the run is transitioning into</p></td>
        </tr>
        <tr>
          <td><code>validated_state</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a proposed state that has committed to the database</p></td>
        </tr>
        <tr>
          <td><code>rule_signature</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a record of rules that have fired on entry into a
managed context, currently only used for debugging purposes</p></td>
        </tr>
        <tr>
          <td><code>finalization_signature</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a record of rules that have fired on exit from a
managed context, currently only used for debugging purposes</p></td>
        </tr>
        <tr>
          <td><code>response_status</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a SetStateStatus object used to build the API response</p></td>
        </tr>
        <tr>
          <td><code>response_details</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a StateResponseDetails object use to build the API response</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session</code></td>
          <td>
          </td>
          <td><p>a SQLAlchemy database session</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>run</code></td>
          <td>
          </td>
          <td><p>the flow run attempting to change state</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>initial_state</code></td>
          <td>
          </td>
          <td><p>the initial state of a run</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>proposed_state</code></td>
          <td>
          </td>
          <td><p>the proposed state a run is transitioning into</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FlowOrchestrationContext</span><span class="p">(</span><span class="n">OrchestrationContext</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A container for a flow run state transition, governed by orchestration rules.</span>

<span class="sd">    When a flow- run attempts to change state, Prefect REST API has an opportunity</span>
<span class="sd">    to decide whether this transition can proceed. All the relevant information</span>
<span class="sd">    associated with the state transition is stored in an `OrchestrationContext`,</span>
<span class="sd">    which is subsequently governed by nested orchestration rules implemented using</span>
<span class="sd">    the `BaseOrchestrationRule` ABC.</span>

<span class="sd">    `FlowOrchestrationContext` introduces the concept of a state being `None` in the</span>
<span class="sd">    context of an intended state transition. An initial state can be `None` if a run</span>
<span class="sd">    is is attempting to set a state for the first time. The proposed state might be</span>
<span class="sd">    `None` if a rule governing the transition determines that no state change</span>
<span class="sd">    should occur at all and nothing is written to the database.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        session: a SQLAlchemy database session</span>
<span class="sd">        run: the flow run attempting to change state</span>
<span class="sd">        initial_state: the initial state of the run</span>
<span class="sd">        proposed_state: the proposed state the run is transitioning into</span>
<span class="sd">        validated_state: a proposed state that has committed to the database</span>
<span class="sd">        rule_signature: a record of rules that have fired on entry into a</span>
<span class="sd">            managed context, currently only used for debugging purposes</span>
<span class="sd">        finalization_signature: a record of rules that have fired on exit from a</span>
<span class="sd">            managed context, currently only used for debugging purposes</span>
<span class="sd">        response_status: a SetStateStatus object used to build the API response</span>
<span class="sd">        response_details:a StateResponseDetails object use to build the API response</span>

<span class="sd">    Args:</span>
<span class="sd">        session: a SQLAlchemy database session</span>
<span class="sd">        run: the flow run attempting to change state</span>
<span class="sd">        initial_state: the initial state of a run</span>
<span class="sd">        proposed_state: the proposed state a run is transitioning into</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># run: db.FlowRun = ...</span>
    <span class="n">run</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="o">...</span>

    <span class="nd">@inject_db</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">validate_proposed_state</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">db</span><span class="p">:</span> <span class="n">PrefectDBInterface</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates a proposed state by committing it to the database.</span>

<span class="sd">        After the `FlowOrchestrationContext` is governed by orchestration rules, the</span>
<span class="sd">        proposed state can be validated: the proposed state is added to the current</span>
<span class="sd">        SQLAlchemy session and is flushed. `self.validated_state` set to the flushed</span>
<span class="sd">        state. The state on the run is set to the validated state as well.</span>

<span class="sd">        If the proposed state is `None` when this method is called, no state will be</span>
<span class="sd">        written and `self.validated_state` will be set to the run&#39;s current state.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_proposed_state</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Encountered error during state validation&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">reason</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error validating state: </span><span class="si">{</span><span class="n">exc</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">ABORT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateAbortDetails</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">)</span>

    <span class="nd">@inject_db</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_validate_proposed_state</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">db</span><span class="p">:</span> <span class="n">PrefectDBInterface</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">validated_orm_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">state</span>
            <span class="n">state_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">state_payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">shallow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">state_data</span> <span class="o">=</span> <span class="n">state_payload</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">state_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">state_result_artifact</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">Artifact</span><span class="o">.</span><span class="n">from_result</span><span class="p">(</span><span class="n">state_data</span><span class="p">)</span>
                <span class="n">state_result_artifact</span><span class="o">.</span><span class="n">flow_run_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span>
                <span class="k">await</span> <span class="n">artifacts</span><span class="o">.</span><span class="n">create_artifact</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">state_result_artifact</span><span class="p">)</span>
                <span class="n">state_payload</span><span class="p">[</span><span class="s2">&quot;result_artifact_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">state_result_artifact</span><span class="o">.</span><span class="n">id</span>

            <span class="n">validated_orm_state</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">FlowRunState</span><span class="p">(</span>
                <span class="n">flow_run_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="o">**</span><span class="n">state_payload</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">validated_orm_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">validated_orm_state</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">validated_orm_state</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span> <span class="o">=</span> <span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">from_orm_without_result</span><span class="p">(</span>
                <span class="n">validated_orm_state</span><span class="p">,</span> <span class="n">with_data</span><span class="o">=</span><span class="n">state_data</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">safe_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a mostly-mutation-safe copy for use in orchestration rules.</span>

<span class="sd">        Orchestration rules govern state transitions using information stored in</span>
<span class="sd">        an `OrchestrationContext`. However, mutating objects stored on the context</span>
<span class="sd">        directly can have unintended side-effects. To guard against this,</span>
<span class="sd">        `self.safe_copy` can be used to pass information to orchestration rules</span>
<span class="sd">        without risking mutation.</span>

<span class="sd">        Note:</span>
<span class="sd">            `self.run` is an ORM model, and even when copied is unsafe to mutate</span>

<span class="sd">        Returns:</span>
<span class="sd">            A mutation-safe copy of `FlowOrchestrationContext`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">safe_copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">run_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run-level settings used to orchestrate the state transition.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">task_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">flow_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="prefect.server.orchestration.rules.FlowOrchestrationContext.run_settings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_settings</span><span class="p">:</span> <span class="n">Dict</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.FlowOrchestrationContext.run_settings" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run-level settings used to orchestrate the state transition.</p>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.FlowOrchestrationContext.validate_proposed_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_proposed_state</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.FlowOrchestrationContext.validate_proposed_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Validates a proposed state by committing it to the database.</p>
<p>After the <code>FlowOrchestrationContext</code> is governed by orchestration rules, the
proposed state can be validated: the proposed state is added to the current
SQLAlchemy session and is flushed. <code>self.validated_state</code> set to the flushed
state. The state on the run is set to the validated state as well.</p>
<p>If the proposed state is <code>None</code> when this method is called, no state will be
written and <code>self.validated_state</code> will be set to the run's current state.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@inject_db</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">validate_proposed_state</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">db</span><span class="p">:</span> <span class="n">PrefectDBInterface</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates a proposed state by committing it to the database.</span>

<span class="sd">    After the `FlowOrchestrationContext` is governed by orchestration rules, the</span>
<span class="sd">    proposed state can be validated: the proposed state is added to the current</span>
<span class="sd">    SQLAlchemy session and is flushed. `self.validated_state` set to the flushed</span>
<span class="sd">    state. The state on the run is set to the validated state as well.</span>

<span class="sd">    If the proposed state is `None` when this method is called, no state will be</span>
<span class="sd">    written and `self.validated_state` will be set to the run&#39;s current state.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_proposed_state</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Encountered error during state validation&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">reason</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error validating state: </span><span class="si">{</span><span class="n">exc</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">ABORT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateAbortDetails</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.FlowOrchestrationContext.safe_copy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">safe_copy</span></code>

<a href="#prefect.server.orchestration.rules.FlowOrchestrationContext.safe_copy" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a mostly-mutation-safe copy for use in orchestration rules.</p>
<p>Orchestration rules govern state transitions using information stored in
an <code>OrchestrationContext</code>. However, mutating objects stored on the context
directly can have unintended side-effects. To guard against this,
<code>self.safe_copy</code> can be used to pass information to orchestration rules
without risking mutation.</p>

<details class="note">
  <summary>Note</summary>
  <p><code>self.run</code> is an ORM model, and even when copied is unsafe to mutate</p>
</details>
  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>A mutation-safe copy of <code>FlowOrchestrationContext</code></p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">safe_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a mostly-mutation-safe copy for use in orchestration rules.</span>

<span class="sd">    Orchestration rules govern state transitions using information stored in</span>
<span class="sd">    an `OrchestrationContext`. However, mutating objects stored on the context</span>
<span class="sd">    directly can have unintended side-effects. To guard against this,</span>
<span class="sd">    `self.safe_copy` can be used to pass information to orchestration rules</span>
<span class="sd">    without risking mutation.</span>

<span class="sd">    Note:</span>
<span class="sd">        `self.run` is an ORM model, and even when copied is unsafe to mutate</span>

<span class="sd">    Returns:</span>
<span class="sd">        A mutation-safe copy of `FlowOrchestrationContext`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">safe_copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.rules.TaskOrchestrationContext" class="doc doc-heading">
        <code>TaskOrchestrationContext</code>


<a href="#prefect.server.orchestration.rules.TaskOrchestrationContext" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.OrchestrationContext" href="#prefect.server.orchestration.rules.OrchestrationContext">OrchestrationContext</a></code></p>

  
      <p>A container for a task run state transition, governed by orchestration rules.</p>
<p>When a task- run attempts to change state, Prefect REST API has an opportunity
to decide whether this transition can proceed. All the relevant information
associated with the state transition is stored in an <code>OrchestrationContext</code>,
which is subsequently governed by nested orchestration rules implemented using
the <code>BaseOrchestrationRule</code> ABC.</p>
<p><code>TaskOrchestrationContext</code> introduces the concept of a state being <code>None</code> in the
context of an intended state transition. An initial state can be <code>None</code> if a run
is is attempting to set a state for the first time. The proposed state might be
<code>None</code> if a rule governing the transition determines that no state change
should occur at all and nothing is written to the database.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session</code></td>
          <td>
          </td>
          <td><p>a SQLAlchemy database session</p></td>
        </tr>
        <tr>
          <td><code>run</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>the task run attempting to change state</p></td>
        </tr>
        <tr>
          <td><code>initial_state</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>the initial state of the run</p></td>
        </tr>
        <tr>
          <td><code>proposed_state</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>the proposed state the run is transitioning into</p></td>
        </tr>
        <tr>
          <td><code>validated_state</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a proposed state that has committed to the database</p></td>
        </tr>
        <tr>
          <td><code>rule_signature</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a record of rules that have fired on entry into a
managed context, currently only used for debugging purposes</p></td>
        </tr>
        <tr>
          <td><code>finalization_signature</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a record of rules that have fired on exit from a
managed context, currently only used for debugging purposes</p></td>
        </tr>
        <tr>
          <td><code>response_status</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a SetStateStatus object used to build the API response</p></td>
        </tr>
        <tr>
          <td><code>response_details</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>a StateResponseDetails object use to build the API response</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session</code></td>
          <td>
          </td>
          <td><p>a SQLAlchemy database session</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>run</code></td>
          <td>
          </td>
          <td><p>the task run attempting to change state</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>initial_state</code></td>
          <td>
          </td>
          <td><p>the initial state of a run</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>proposed_state</code></td>
          <td>
          </td>
          <td><p>the proposed state a run is transitioning into</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TaskOrchestrationContext</span><span class="p">(</span><span class="n">OrchestrationContext</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A container for a task run state transition, governed by orchestration rules.</span>

<span class="sd">    When a task- run attempts to change state, Prefect REST API has an opportunity</span>
<span class="sd">    to decide whether this transition can proceed. All the relevant information</span>
<span class="sd">    associated with the state transition is stored in an `OrchestrationContext`,</span>
<span class="sd">    which is subsequently governed by nested orchestration rules implemented using</span>
<span class="sd">    the `BaseOrchestrationRule` ABC.</span>

<span class="sd">    `TaskOrchestrationContext` introduces the concept of a state being `None` in the</span>
<span class="sd">    context of an intended state transition. An initial state can be `None` if a run</span>
<span class="sd">    is is attempting to set a state for the first time. The proposed state might be</span>
<span class="sd">    `None` if a rule governing the transition determines that no state change</span>
<span class="sd">    should occur at all and nothing is written to the database.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        session: a SQLAlchemy database session</span>
<span class="sd">        run: the task run attempting to change state</span>
<span class="sd">        initial_state: the initial state of the run</span>
<span class="sd">        proposed_state: the proposed state the run is transitioning into</span>
<span class="sd">        validated_state: a proposed state that has committed to the database</span>
<span class="sd">        rule_signature: a record of rules that have fired on entry into a</span>
<span class="sd">            managed context, currently only used for debugging purposes</span>
<span class="sd">        finalization_signature: a record of rules that have fired on exit from a</span>
<span class="sd">            managed context, currently only used for debugging purposes</span>
<span class="sd">        response_status: a SetStateStatus object used to build the API response</span>
<span class="sd">        response_details:a StateResponseDetails object use to build the API response</span>

<span class="sd">    Args:</span>
<span class="sd">        session: a SQLAlchemy database session</span>
<span class="sd">        run: the task run attempting to change state</span>
<span class="sd">        initial_state: the initial state of a run</span>
<span class="sd">        proposed_state: the proposed state a run is transitioning into</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># run: db.TaskRun = ...</span>
    <span class="n">run</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="o">...</span>

    <span class="nd">@inject_db</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">validate_proposed_state</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">db</span><span class="p">:</span> <span class="n">PrefectDBInterface</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates a proposed state by committing it to the database.</span>

<span class="sd">        After the `TaskOrchestrationContext` is governed by orchestration rules, the</span>
<span class="sd">        proposed state can be validated: the proposed state is added to the current</span>
<span class="sd">        SQLAlchemy session and is flushed. `self.validated_state` set to the flushed</span>
<span class="sd">        state. The state on the run is set to the validated state as well.</span>

<span class="sd">        If the proposed state is `None` when this method is called, no state will be</span>
<span class="sd">        written and `self.validated_state` will be set to the run&#39;s current state.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_proposed_state</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Encountered error during state validation&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">reason</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error validating state: </span><span class="si">{</span><span class="n">exc</span><span class="si">!r}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">ABORT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateAbortDetails</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">)</span>

    <span class="nd">@inject_db</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">_validate_proposed_state</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">db</span><span class="p">:</span> <span class="n">PrefectDBInterface</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">validated_orm_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">state</span>
            <span class="n">state_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">state_payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">shallow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">state_data</span> <span class="o">=</span> <span class="n">state_payload</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">state_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">state_result_artifact</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">Artifact</span><span class="o">.</span><span class="n">from_result</span><span class="p">(</span><span class="n">state_data</span><span class="p">)</span>
                <span class="n">state_result_artifact</span><span class="o">.</span><span class="n">task_run_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span>

                <span class="n">flow_run</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow_run</span><span class="p">()</span>
                <span class="n">state_result_artifact</span><span class="o">.</span><span class="n">flow_run_id</span> <span class="o">=</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">id</span>

                <span class="k">await</span> <span class="n">artifacts</span><span class="o">.</span><span class="n">create_artifact</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span> <span class="n">state_result_artifact</span><span class="p">)</span>
                <span class="n">state_payload</span><span class="p">[</span><span class="s2">&quot;result_artifact_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">state_result_artifact</span><span class="o">.</span><span class="n">id</span>

            <span class="n">validated_orm_state</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">TaskRunState</span><span class="p">(</span>
                <span class="n">task_run_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                <span class="o">**</span><span class="n">state_payload</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">validated_orm_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">validated_orm_state</span><span class="p">)</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">validated_orm_state</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span> <span class="o">=</span> <span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">from_orm_without_result</span><span class="p">(</span>
                <span class="n">validated_orm_state</span><span class="p">,</span> <span class="n">with_data</span><span class="o">=</span><span class="n">state_data</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validated_state</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">safe_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a mostly-mutation-safe copy for use in orchestration rules.</span>

<span class="sd">        Orchestration rules govern state transitions using information stored in</span>
<span class="sd">        an `OrchestrationContext`. However, mutating objects stored on the context</span>
<span class="sd">        directly can have unintended side-effects. To guard against this,</span>
<span class="sd">        `self.safe_copy` can be used to pass information to orchestration rules</span>
<span class="sd">        without risking mutation.</span>

<span class="sd">        Note:</span>
<span class="sd">            `self.run` is an ORM model, and even when copied is unsafe to mutate</span>

<span class="sd">        Returns:</span>
<span class="sd">            A mutation-safe copy of `TaskOrchestrationContext`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">safe_copy</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">run_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run-level settings used to orchestrate the state transition.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">empirical_policy</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">task_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">flow_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">flow_runs</span><span class="o">.</span><span class="n">read_flow_run</span><span class="p">(</span>
            <span class="n">session</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">,</span>
            <span class="n">flow_run_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">flow_run_id</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="prefect.server.orchestration.rules.TaskOrchestrationContext.run_settings" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_settings</span><span class="p">:</span> <span class="n">Dict</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.TaskOrchestrationContext.run_settings" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Run-level settings used to orchestrate the state transition.</p>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.TaskOrchestrationContext.validate_proposed_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_proposed_state</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.TaskOrchestrationContext.validate_proposed_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Validates a proposed state by committing it to the database.</p>
<p>After the <code>TaskOrchestrationContext</code> is governed by orchestration rules, the
proposed state can be validated: the proposed state is added to the current
SQLAlchemy session and is flushed. <code>self.validated_state</code> set to the flushed
state. The state on the run is set to the validated state as well.</p>
<p>If the proposed state is <code>None</code> when this method is called, no state will be
written and <code>self.validated_state</code> will be set to the run's current state.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@inject_db</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">validate_proposed_state</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">db</span><span class="p">:</span> <span class="n">PrefectDBInterface</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates a proposed state by committing it to the database.</span>

<span class="sd">    After the `TaskOrchestrationContext` is governed by orchestration rules, the</span>
<span class="sd">    proposed state can be validated: the proposed state is added to the current</span>
<span class="sd">    SQLAlchemy session and is flushed. `self.validated_state` set to the flushed</span>
<span class="sd">    state. The state on the run is set to the validated state as well.</span>

<span class="sd">    If the proposed state is `None` when this method is called, no state will be</span>
<span class="sd">    written and `self.validated_state` will be set to the run&#39;s current state.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_proposed_state</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Encountered error during state validation&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">reason</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error validating state: </span><span class="si">{</span><span class="n">exc</span><span class="si">!r}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">ABORT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateAbortDetails</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.TaskOrchestrationContext.safe_copy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">safe_copy</span></code>

<a href="#prefect.server.orchestration.rules.TaskOrchestrationContext.safe_copy" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a mostly-mutation-safe copy for use in orchestration rules.</p>
<p>Orchestration rules govern state transitions using information stored in
an <code>OrchestrationContext</code>. However, mutating objects stored on the context
directly can have unintended side-effects. To guard against this,
<code>self.safe_copy</code> can be used to pass information to orchestration rules
without risking mutation.</p>

<details class="note">
  <summary>Note</summary>
  <p><code>self.run</code> is an ORM model, and even when copied is unsafe to mutate</p>
</details>
  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>A mutation-safe copy of <code>TaskOrchestrationContext</code></p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">safe_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a mostly-mutation-safe copy for use in orchestration rules.</span>

<span class="sd">    Orchestration rules govern state transitions using information stored in</span>
<span class="sd">    an `OrchestrationContext`. However, mutating objects stored on the context</span>
<span class="sd">    directly can have unintended side-effects. To guard against this,</span>
<span class="sd">    `self.safe_copy` can be used to pass information to orchestration rules</span>
<span class="sd">    without risking mutation.</span>

<span class="sd">    Note:</span>
<span class="sd">        `self.run` is an ORM model, and even when copied is unsafe to mutate</span>

<span class="sd">    Returns:</span>
<span class="sd">        A mutation-safe copy of `TaskOrchestrationContext`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">safe_copy</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.rules.BaseOrchestrationRule" class="doc doc-heading">
        <code>BaseOrchestrationRule</code>


<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>contextlib.<span title="contextlib.AbstractAsyncContextManager">AbstractAsyncContextManager</span></code></p>

  
      <p>An abstract base class used to implement a discrete piece of orchestration logic.</p>
<p>An <code>OrchestrationRule</code> is a stateful context manager that directly governs a state
transition. Complex orchestration is achieved by nesting multiple rules.
Each rule runs against an <code>OrchestrationContext</code> that contains the transition
details; this context is then passed to subsequent rules. The context can be
modified by hooks that fire before and after a new state is validated and committed
to the database. These hooks will fire as long as the state transition is
considered "valid" and govern a transition by either modifying the proposed state
before it is validated or by producing a side-effect.</p>
<p>A state transition occurs whenever a flow- or task- run changes state, prompting
Prefect REST API to decide whether or not this transition can proceed. The current state of
the run is referred to as the "initial state", and the state a run is
attempting to transition into is the "proposed state". Together, the initial state
transitioning into the proposed state is the intended transition that is governed
by these orchestration rules. After using rules to enter a runtime context, the
<code>OrchestrationContext</code> will contain a proposed state that has been governed by
each rule, and at that point can validate the proposed state and commit it to
the database. The validated state will be set on the context as
<code>context.validated_state</code>, and rules will call the <code>self.after_transition</code> hook
upon exiting the managed context.</p>

<p><strong>Examples:</strong></p>
    <p>Create a rule:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">BasicRule</span><span class="p">(</span><span class="n">BaseOrchestrationRule</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># allowed initial state types</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">FROM_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># allowed proposed state types</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">TO_STATES</span> <span class="o">=</span> <span class="p">[</span><span class="n">StateType</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">,</span> <span class="n">StateType</span><span class="o">.</span><span class="n">FAILED</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">proposed_state</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="c1"># side effects and proposed state mutation can happen here</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">validated_state</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="c1"># operations on states that have been validated can happen here</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">async</span> <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span><span class="n">intitial_state</span><span class="p">,</span> <span class="n">validated_state</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="c1"># reverts side effects generated by `before_transition` if necessary</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span>
</code></pre></div>
    <p>Use a rule:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">intended_transition</span> <span class="o">=</span> <span class="p">(</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">,</span> <span class="n">StateType</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">async</span> <span class="k">with</span> <span class="n">BasicRule</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">*</span><span class="n">intended_transition</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># context.proposed_state has been governed by BasicRule</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</code></pre></div>
    <p>Use multiple rules:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">BasicRule</span><span class="p">,</span> <span class="n">BasicRule</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intended_transition</span> <span class="o">=</span> <span class="p">(</span><span class="n">StateType</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">,</span> <span class="n">StateType</span><span class="o">.</span><span class="n">COMPLETED</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">async</span> <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">AsyncExitStack</span><span class="p">()</span> <span class="k">as</span> <span class="n">stack</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">stack</span><span class="o">.</span><span class="n">enter_async_context</span><span class="p">(</span><span class="n">rule</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">*</span><span class="n">intended_transition</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># context.proposed_state has been governed by all rules</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</code></pre></div>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>FROM_STATES</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span></code>
          </td>
          <td><p>list of valid initial state types this rule governs</p></td>
        </tr>
        <tr>
          <td><code>TO_STATES</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span></code>
          </td>
          <td><p>list of valid proposed state types this rule governs</p></td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
          </td>
          <td><p>the orchestration context</p></td>
        </tr>
        <tr>
          <td><code>from_state_type</code></td>
          <td>
          </td>
          <td><p>the state type a run is currently in</p></td>
        </tr>
        <tr>
          <td><code>to_state_type</code></td>
          <td>
          </td>
          <td><p>the intended proposed state type prior to any orchestration</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.OrchestrationContext" href="#prefect.server.orchestration.rules.OrchestrationContext">OrchestrationContext</a></code>
          </td>
          <td><p>A <code>FlowOrchestrationContext</code> or <code>TaskOrchestrationContext</code> that is
passed between rules</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>from_state_type</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.StateType" href="../../schemas/states/#prefect.server.schemas.states.StateType">StateType</a>]</code>
          </td>
          <td><p>The state type of the initial state of a run, if this
state type is not contained in <code>FROM_STATES</code>, no hooks will fire</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>to_state_type</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.StateType" href="../../schemas/states/#prefect.server.schemas.states.StateType">StateType</a>]</code>
          </td>
          <td><p>The state type of the proposed state before orchestration, if
this state type is not contained in <code>TO_STATES</code>, no hooks will fire</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BaseOrchestrationRule</span><span class="p">(</span><span class="n">contextlib</span><span class="o">.</span><span class="n">AbstractAsyncContextManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An abstract base class used to implement a discrete piece of orchestration logic.</span>

<span class="sd">    An `OrchestrationRule` is a stateful context manager that directly governs a state</span>
<span class="sd">    transition. Complex orchestration is achieved by nesting multiple rules.</span>
<span class="sd">    Each rule runs against an `OrchestrationContext` that contains the transition</span>
<span class="sd">    details; this context is then passed to subsequent rules. The context can be</span>
<span class="sd">    modified by hooks that fire before and after a new state is validated and committed</span>
<span class="sd">    to the database. These hooks will fire as long as the state transition is</span>
<span class="sd">    considered &quot;valid&quot; and govern a transition by either modifying the proposed state</span>
<span class="sd">    before it is validated or by producing a side-effect.</span>

<span class="sd">    A state transition occurs whenever a flow- or task- run changes state, prompting</span>
<span class="sd">    Prefect REST API to decide whether or not this transition can proceed. The current state of</span>
<span class="sd">    the run is referred to as the &quot;initial state&quot;, and the state a run is</span>
<span class="sd">    attempting to transition into is the &quot;proposed state&quot;. Together, the initial state</span>
<span class="sd">    transitioning into the proposed state is the intended transition that is governed</span>
<span class="sd">    by these orchestration rules. After using rules to enter a runtime context, the</span>
<span class="sd">    `OrchestrationContext` will contain a proposed state that has been governed by</span>
<span class="sd">    each rule, and at that point can validate the proposed state and commit it to</span>
<span class="sd">    the database. The validated state will be set on the context as</span>
<span class="sd">    `context.validated_state`, and rules will call the `self.after_transition` hook</span>
<span class="sd">    upon exiting the managed context.</span>

<span class="sd">    Examples:</span>

<span class="sd">        Create a rule:</span>

<span class="sd">        &gt;&gt;&gt; class BasicRule(BaseOrchestrationRule):</span>
<span class="sd">        &gt;&gt;&gt;     # allowed initial state types</span>
<span class="sd">        &gt;&gt;&gt;     FROM_STATES = [StateType.RUNNING]</span>
<span class="sd">        &gt;&gt;&gt;     # allowed proposed state types</span>
<span class="sd">        &gt;&gt;&gt;     TO_STATES = [StateType.COMPLETED, StateType.FAILED]</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt;     async def before_transition(initial_state, proposed_state, ctx):</span>
<span class="sd">        &gt;&gt;&gt;         # side effects and proposed state mutation can happen here</span>
<span class="sd">        &gt;&gt;&gt;         ...</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt;     async def after_transition(initial_state, validated_state, ctx):</span>
<span class="sd">        &gt;&gt;&gt;         # operations on states that have been validated can happen here</span>
<span class="sd">        &gt;&gt;&gt;         ...</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt;     async def cleanup(intitial_state, validated_state, ctx):</span>
<span class="sd">        &gt;&gt;&gt;         # reverts side effects generated by `before_transition` if necessary</span>
<span class="sd">        &gt;&gt;&gt;         ...</span>

<span class="sd">        Use a rule:</span>

<span class="sd">        &gt;&gt;&gt; intended_transition = (StateType.RUNNING, StateType.COMPLETED)</span>
<span class="sd">        &gt;&gt;&gt; async with BasicRule(context, *intended_transition):</span>
<span class="sd">        &gt;&gt;&gt;     # context.proposed_state has been governed by BasicRule</span>
<span class="sd">        &gt;&gt;&gt;     ...</span>

<span class="sd">        Use multiple rules:</span>

<span class="sd">        &gt;&gt;&gt; rules = [BasicRule, BasicRule]</span>
<span class="sd">        &gt;&gt;&gt; intended_transition = (StateType.RUNNING, StateType.COMPLETED)</span>
<span class="sd">        &gt;&gt;&gt; async with contextlib.AsyncExitStack() as stack:</span>
<span class="sd">        &gt;&gt;&gt;     for rule in rules:</span>
<span class="sd">        &gt;&gt;&gt;         stack.enter_async_context(rule(context, *intended_transition))</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt;     # context.proposed_state has been governed by all rules</span>
<span class="sd">        &gt;&gt;&gt;     ...</span>

<span class="sd">    Attributes:</span>
<span class="sd">        FROM_STATES: list of valid initial state types this rule governs</span>
<span class="sd">        TO_STATES: list of valid proposed state types this rule governs</span>
<span class="sd">        context: the orchestration context</span>
<span class="sd">        from_state_type: the state type a run is currently in</span>
<span class="sd">        to_state_type: the intended proposed state type prior to any orchestration</span>

<span class="sd">    Args:</span>
<span class="sd">        context: A `FlowOrchestrationContext` or `TaskOrchestrationContext` that is</span>
<span class="sd">            passed between rules</span>
<span class="sd">        from_state_type: The state type of the initial state of a run, if this</span>
<span class="sd">            state type is not contained in `FROM_STATES`, no hooks will fire</span>
<span class="sd">        to_state_type: The state type of the proposed state before orchestration, if</span>
<span class="sd">            this state type is not contained in `TO_STATES`, no hooks will fire</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">FROM_STATES</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">TO_STATES</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
        <span class="n">from_state_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">],</span>
        <span class="n">to_state_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_state_type</span> <span class="o">=</span> <span class="n">from_state_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="n">to_state_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OrchestrationContext</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enter an async runtime context governed by this rule.</span>

<span class="sd">        The `with` statement will bind a governed `OrchestrationContext` to the target</span>
<span class="sd">        specified by the `as` clause. If the transition proposed by the</span>
<span class="sd">        `OrchestrationContext` is considered invalid on entry, entering this context</span>
<span class="sd">        will do nothing. Otherwise, `self.before_transition` will fire.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">invalid</span><span class="p">():</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">entry_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">entry_context</span><span class="p">()</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">before_transition</span><span class="p">(</span><span class="o">*</span><span class="n">entry_context</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">rule_signature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">before_transition_error</span><span class="p">:</span>
                <span class="n">reason</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Aborting orchestration due to error in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="si">!r}</span><span class="s2">:&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; !</span><span class="si">{</span><span class="n">before_transition_error</span><span class="si">!r}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Error running before-transition hook in rule </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="si">!r}</span><span class="s2">:&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot; !</span><span class="si">{</span><span class="n">before_transition_error</span><span class="si">!r}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">ABORT</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateAbortDetails</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">orchestration_error</span> <span class="o">=</span> <span class="n">before_transition_error</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aexit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exc_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exc_val</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exc_tb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exit the async runtime context governed by this rule.</span>

<span class="sd">        One of three outcomes can happen upon exiting this rule&#39;s context depending on</span>
<span class="sd">        the state of the rule. If the rule was found to be invalid on entry, nothing</span>
<span class="sd">        happens. If the rule was valid on entry and continues to be valid on exit,</span>
<span class="sd">        `self.after_transition` will fire. If the rule was valid on entry but invalid</span>
<span class="sd">        on exit, the rule will &quot;fizzle&quot; and `self.cleanup` will fire in order to revert</span>
<span class="sd">        any side-effects produced by `self.before_transition`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">exit_context</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">exit_context</span><span class="p">()</span>
        <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">invalid</span><span class="p">():</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">fizzled</span><span class="p">():</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleanup</span><span class="p">(</span><span class="o">*</span><span class="n">exit_context</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">after_transition</span><span class="p">(</span><span class="o">*</span><span class="n">exit_context</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">finalization_signature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements a hook that can fire before a state is committed to the database.</span>

<span class="sd">        This hook may produce side-effects or mutate the proposed state of a</span>
<span class="sd">        transition using one of four methods: `self.reject_transition`,</span>
<span class="sd">        `self.delay_transition`, `self.abort_transition`, and `self.rename_state`.</span>

<span class="sd">        Note:</span>
<span class="sd">            As currently implemented, the `before_transition` hook is not</span>
<span class="sd">            perfectly isolated from mutating the transition. It is a standard instance</span>
<span class="sd">            method that has access to `self`, and therefore `self.context`. This should</span>
<span class="sd">            never be modified directly. Furthermore, `context.run` is an ORM model, and</span>
<span class="sd">            mutating the run can also cause unintended writes to the database.</span>

<span class="sd">        Args:</span>
<span class="sd">            initial_state: The initial state of a transtion</span>
<span class="sd">            proposed_state: The proposed state of a transition</span>
<span class="sd">            context: A safe copy of the `OrchestrationContext`, with the exception of</span>
<span class="sd">                `context.run`, mutating this context will have no effect on the broader</span>
<span class="sd">                orchestration environment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements a hook that can fire after a state is committed to the database.</span>

<span class="sd">        Args:</span>
<span class="sd">            initial_state: The initial state of a transtion</span>
<span class="sd">            validated_state: The governed state that has been committed to the database</span>
<span class="sd">            context: A safe copy of the `OrchestrationContext`, with the exception of</span>
<span class="sd">                `context.run`, mutating this context will have no effect on the broader</span>
<span class="sd">                orchestration environment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements a hook that can fire after a state is committed to the database.</span>

<span class="sd">        The intended use of this method is to revert side-effects produced by</span>
<span class="sd">        `self.before_transition` when the transition is found to be invalid on exit.</span>
<span class="sd">        This allows multiple rules to be gracefully run in sequence, without logic that</span>
<span class="sd">        keeps track of all other rules that might govern a transition.</span>

<span class="sd">        Args:</span>
<span class="sd">            initial_state: The initial state of a transtion</span>
<span class="sd">            validated_state: The governed state that has been committed to the database</span>
<span class="sd">            context: A safe copy of the `OrchestrationContext`, with the exception of</span>
<span class="sd">                `context.run`, mutating this context will have no effect on the broader</span>
<span class="sd">                orchestration environment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines if a rule is invalid.</span>

<span class="sd">        Invalid rules do nothing and no hooks fire upon entering or exiting a governed</span>
<span class="sd">        context. Rules are invalid if the transition states types are not contained in</span>
<span class="sd">        `self.FROM_STATES` and `self.TO_STATES`, or if the context is proposing</span>
<span class="sd">        a transition that differs from the transition the rule was instantiated with.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the rules in invalid, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># invalid and fizzled states are mutually exclusive,</span>
        <span class="c1"># `_invalid_on_entry` holds this statefulness</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_state_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FROM_STATES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TO_STATES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">invalid_transition</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">fizzled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines if a rule is fizzled and side-effects need to be reverted.</span>

<span class="sd">        Rules are fizzled if the transitions were valid on entry (thus firing</span>
<span class="sd">        `self.before_transition`) but are invalid upon exiting the governed context,</span>
<span class="sd">        most likely caused by another rule mutating the transition.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the rule is fizzled, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">invalid_transition</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">invalid_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines if the transition proposed by the `OrchestrationContext` is invalid.</span>

<span class="sd">        If the `OrchestrationContext` is attempting to manage a transition with this</span>
<span class="sd">        rule that differs from the transition the rule was instantiated with, the</span>
<span class="sd">        transition is considered to be invalid. Depending on the context, a rule with an</span>
<span class="sd">        invalid transition is either &quot;invalid&quot; or &quot;fizzled&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the transition is invalid, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">initial_state_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">initial_state_type</span>
        <span class="n">proposed_state_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state_type</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">from_state_type</span> <span class="o">!=</span> <span class="n">initial_state_type</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">!=</span> <span class="n">proposed_state_type</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">reject_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rejects a proposed transition before the transition is validated.</span>

<span class="sd">        This method will reject a proposed transition, mutating the proposed state to</span>
<span class="sd">        the provided `state`. A reason for rejecting the transition is also passed on</span>
<span class="sd">        to the `OrchestrationContext`. Rules that reject the transition will not fizzle,</span>
<span class="sd">        despite the proposed state type changing.</span>

<span class="sd">        Args:</span>
<span class="sd">            state: The new proposed state. If `None`, the current run state will be</span>
<span class="sd">                returned in the result instead.</span>
<span class="sd">            reason: The reason for rejecting the transition</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># don&#39;t run if the transition is already validated</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">validated_state</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The transition is already validated&quot;</span><span class="p">)</span>

        <span class="c1"># the current state will be used if a new one is not provided</span>
        <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_state_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">OrchestrationError</span><span class="p">(</span>
                    <span class="s2">&quot;The current run has no state; this transition cannot be &quot;</span>
                    <span class="s2">&quot;rejected without providing a new state.&quot;</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># a rule that mutates state should not fizzle itself</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">type</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="n">state</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">REJECT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateRejectDetails</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">delay_transition</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">delay_seconds</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delays a proposed transition before the transition is validated.</span>

<span class="sd">        This method will delay a proposed transition, setting the proposed state to</span>
<span class="sd">        `None`, signaling to the `OrchestrationContext` that no state should be</span>
<span class="sd">        written to the database. The number of seconds a transition should be delayed is</span>
<span class="sd">        passed to the `OrchestrationContext`. A reason for delaying the transition is</span>
<span class="sd">        also provided. Rules that delay the transition will not fizzle, despite the</span>
<span class="sd">        proposed state type changing.</span>

<span class="sd">        Args:</span>
<span class="sd">            delay_seconds: The number of seconds the transition should be delayed</span>
<span class="sd">            reason: The reason for delaying the transition</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># don&#39;t run if the transition is already validated</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">validated_state</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The transition is already validated&quot;</span><span class="p">)</span>

        <span class="c1"># a rule that mutates state should not fizzle itself</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">WAIT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateWaitDetails</span><span class="p">(</span>
            <span class="n">delay_seconds</span><span class="o">=</span><span class="n">delay_seconds</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="n">reason</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">abort_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aborts a proposed transition before the transition is validated.</span>

<span class="sd">        This method will abort a proposed transition, expecting no further action to</span>
<span class="sd">        occur for this run. The proposed state is set to `None`, signaling to the</span>
<span class="sd">        `OrchestrationContext` that no state should be written to the database. A</span>
<span class="sd">        reason for aborting the transition is also provided. Rules that abort the</span>
<span class="sd">        transition will not fizzle, despite the proposed state type changing.</span>

<span class="sd">        Args:</span>
<span class="sd">            reason: The reason for aborting the transition</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># don&#39;t run if the transition is already validated</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">validated_state</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The transition is already validated&quot;</span><span class="p">)</span>

        <span class="c1"># a rule that mutates state should not fizzle itself</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">ABORT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateAbortDetails</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">rename_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the &quot;name&quot; attribute on a proposed state.</span>

<span class="sd">        The name of a state is an annotation intended to provide rich, human-readable</span>
<span class="sd">        context for how a run is progressing. This method only updates the name and not</span>
<span class="sd">        the canonical state TYPE, and will not fizzle or invalidate any other rules</span>
<span class="sd">        that might govern this state transition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">state_name</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">update_context_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the &quot;parameters&quot; dictionary attribute with the specified key-value pair.</span>

<span class="sd">        This mechanism streamlines the process of passing messages and information</span>
<span class="sd">        between orchestration rules if necessary and is simpler and more ephemeral than</span>
<span class="sd">        message-passing via the database or some other side-effect. This mechanism can</span>
<span class="sd">        be used to break up large rules for ease of testing or comprehension, but note</span>
<span class="sd">        that any rules coupled this way (or any other way) are no longer independent and</span>
<span class="sd">        the order in which they appear in the orchestration policy priority will matter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.before_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">before_transition</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.before_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Implements a hook that can fire before a state is committed to the database.</p>
<p>This hook may produce side-effects or mutate the proposed state of a
transition using one of four methods: <code>self.reject_transition</code>,
<code>self.delay_transition</code>, <code>self.abort_transition</code>, and <code>self.rename_state</code>.</p>

<details class="note">
  <summary>Note</summary>
  <p>As currently implemented, the <code>before_transition</code> hook is not
perfectly isolated from mutating the transition. It is a standard instance
method that has access to <code>self</code>, and therefore <code>self.context</code>. This should
never be modified directly. Furthermore, <code>context.run</code> is an ORM model, and
mutating the run can also cause unintended writes to the database.</p>
</details>
  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>initial_state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>The initial state of a transtion</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>proposed_state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>The proposed state of a transition</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.OrchestrationContext" href="#prefect.server.orchestration.rules.OrchestrationContext">OrchestrationContext</a></code>
          </td>
          <td><p>A safe copy of the <code>OrchestrationContext</code>, with the exception of
<code>context.run</code>, mutating this context will have no effect on the broader
orchestration environment.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
    <span class="n">proposed_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements a hook that can fire before a state is committed to the database.</span>

<span class="sd">    This hook may produce side-effects or mutate the proposed state of a</span>
<span class="sd">    transition using one of four methods: `self.reject_transition`,</span>
<span class="sd">    `self.delay_transition`, `self.abort_transition`, and `self.rename_state`.</span>

<span class="sd">    Note:</span>
<span class="sd">        As currently implemented, the `before_transition` hook is not</span>
<span class="sd">        perfectly isolated from mutating the transition. It is a standard instance</span>
<span class="sd">        method that has access to `self`, and therefore `self.context`. This should</span>
<span class="sd">        never be modified directly. Furthermore, `context.run` is an ORM model, and</span>
<span class="sd">        mutating the run can also cause unintended writes to the database.</span>

<span class="sd">    Args:</span>
<span class="sd">        initial_state: The initial state of a transtion</span>
<span class="sd">        proposed_state: The proposed state of a transition</span>
<span class="sd">        context: A safe copy of the `OrchestrationContext`, with the exception of</span>
<span class="sd">            `context.run`, mutating this context will have no effect on the broader</span>
<span class="sd">            orchestration environment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.after_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">after_transition</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.after_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Implements a hook that can fire after a state is committed to the database.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>initial_state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>The initial state of a transtion</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>validated_state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>The governed state that has been committed to the database</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.OrchestrationContext" href="#prefect.server.orchestration.rules.OrchestrationContext">OrchestrationContext</a></code>
          </td>
          <td><p>A safe copy of the <code>OrchestrationContext</code>, with the exception of
<code>context.run</code>, mutating this context will have no effect on the broader
orchestration environment.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
    <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements a hook that can fire after a state is committed to the database.</span>

<span class="sd">    Args:</span>
<span class="sd">        initial_state: The initial state of a transtion</span>
<span class="sd">        validated_state: The governed state that has been committed to the database</span>
<span class="sd">        context: A safe copy of the `OrchestrationContext`, with the exception of</span>
<span class="sd">            `context.run`, mutating this context will have no effect on the broader</span>
<span class="sd">            orchestration environment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.cleanup" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cleanup</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.cleanup" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Implements a hook that can fire after a state is committed to the database.</p>
<p>The intended use of this method is to revert side-effects produced by
<code>self.before_transition</code> when the transition is found to be invalid on exit.
This allows multiple rules to be gracefully run in sequence, without logic that
keeps track of all other rules that might govern a transition.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>initial_state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>The initial state of a transtion</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>validated_state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>The governed state that has been committed to the database</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.OrchestrationContext" href="#prefect.server.orchestration.rules.OrchestrationContext">OrchestrationContext</a></code>
          </td>
          <td><p>A safe copy of the <code>OrchestrationContext</code>, with the exception of
<code>context.run</code>, mutating this context will have no effect on the broader
orchestration environment.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">cleanup</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
    <span class="n">validated_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span>
    <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements a hook that can fire after a state is committed to the database.</span>

<span class="sd">    The intended use of this method is to revert side-effects produced by</span>
<span class="sd">    `self.before_transition` when the transition is found to be invalid on exit.</span>
<span class="sd">    This allows multiple rules to be gracefully run in sequence, without logic that</span>
<span class="sd">    keeps track of all other rules that might govern a transition.</span>

<span class="sd">    Args:</span>
<span class="sd">        initial_state: The initial state of a transtion</span>
<span class="sd">        validated_state: The governed state that has been committed to the database</span>
<span class="sd">        context: A safe copy of the `OrchestrationContext`, with the exception of</span>
<span class="sd">            `context.run`, mutating this context will have no effect on the broader</span>
<span class="sd">            orchestration environment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.invalid" class="doc doc-heading">
<code class="highlight language-python"><span class="n">invalid</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.invalid" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Determines if a rule is invalid.</p>
<p>Invalid rules do nothing and no hooks fire upon entering or exiting a governed
context. Rules are invalid if the transition states types are not contained in
<code>self.FROM_STATES</code> and <code>self.TO_STATES</code>, or if the context is proposing
a transition that differs from the transition the rule was instantiated with.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td><p>True if the rules in invalid, False otherwise.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">invalid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines if a rule is invalid.</span>

<span class="sd">    Invalid rules do nothing and no hooks fire upon entering or exiting a governed</span>
<span class="sd">    context. Rules are invalid if the transition states types are not contained in</span>
<span class="sd">    `self.FROM_STATES` and `self.TO_STATES`, or if the context is proposing</span>
<span class="sd">    a transition that differs from the transition the rule was instantiated with.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the rules in invalid, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># invalid and fizzled states are mutually exclusive,</span>
    <span class="c1"># `_invalid_on_entry` holds this statefulness</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_state_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FROM_STATES</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TO_STATES</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">invalid_transition</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.fizzled" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fizzled</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.fizzled" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Determines if a rule is fizzled and side-effects need to be reverted.</p>
<p>Rules are fizzled if the transitions were valid on entry (thus firing
<code>self.before_transition</code>) but are invalid upon exiting the governed context,
most likely caused by another rule mutating the transition.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td><p>True if the rule is fizzled, False otherwise.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">fizzled</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines if a rule is fizzled and side-effects need to be reverted.</span>

<span class="sd">    Rules are fizzled if the transitions were valid on entry (thus firing</span>
<span class="sd">    `self.before_transition`) but are invalid upon exiting the governed context,</span>
<span class="sd">    most likely caused by another rule mutating the transition.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the rule is fizzled, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_invalid_on_entry</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">invalid_transition</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.invalid_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">invalid_transition</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.invalid_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Determines if the transition proposed by the <code>OrchestrationContext</code> is invalid.</p>
<p>If the <code>OrchestrationContext</code> is attempting to manage a transition with this
rule that differs from the transition the rule was instantiated with, the
transition is considered to be invalid. Depending on the context, a rule with an
invalid transition is either "invalid" or "fizzled".</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td><p>True if the transition is invalid, False otherwise.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">invalid_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines if the transition proposed by the `OrchestrationContext` is invalid.</span>

<span class="sd">    If the `OrchestrationContext` is attempting to manage a transition with this</span>
<span class="sd">    rule that differs from the transition the rule was instantiated with, the</span>
<span class="sd">    transition is considered to be invalid. Depending on the context, a rule with an</span>
<span class="sd">    invalid transition is either &quot;invalid&quot; or &quot;fizzled&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the transition is invalid, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">initial_state_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">initial_state_type</span>
    <span class="n">proposed_state_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state_type</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">from_state_type</span> <span class="o">!=</span> <span class="n">initial_state_type</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">!=</span> <span class="n">proposed_state_type</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.reject_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reject_transition</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.reject_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Rejects a proposed transition before the transition is validated.</p>
<p>This method will reject a proposed transition, mutating the proposed state to
the provided <code>state</code>. A reason for rejecting the transition is also passed on
to the <code>OrchestrationContext</code>. Rules that reject the transition will not fizzle,
despite the proposed state type changing.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>state</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="prefect.server.schemas.states" href="../../schemas/states/#prefect.server.schemas.states">states</a>.<a class="autorefs autorefs-internal" title="prefect.server.schemas.states.State" href="../../schemas/states/#prefect.server.schemas.states.State">State</a>]</code>
          </td>
          <td><p>The new proposed state. If <code>None</code>, the current run state will be
returned in the result instead.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>reason</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The reason for rejecting the transition</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">reject_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">State</span><span class="p">],</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rejects a proposed transition before the transition is validated.</span>

<span class="sd">    This method will reject a proposed transition, mutating the proposed state to</span>
<span class="sd">    the provided `state`. A reason for rejecting the transition is also passed on</span>
<span class="sd">    to the `OrchestrationContext`. Rules that reject the transition will not fizzle,</span>
<span class="sd">    despite the proposed state type changing.</span>

<span class="sd">    Args:</span>
<span class="sd">        state: The new proposed state. If `None`, the current run state will be</span>
<span class="sd">            returned in the result instead.</span>
<span class="sd">        reason: The reason for rejecting the transition</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># don&#39;t run if the transition is already validated</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">validated_state</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The transition is already validated&quot;</span><span class="p">)</span>

    <span class="c1"># the current state will be used if a new one is not provided</span>
    <span class="k">if</span> <span class="n">state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">from_state_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">OrchestrationError</span><span class="p">(</span>
                <span class="s2">&quot;The current run has no state; this transition cannot be &quot;</span>
                <span class="s2">&quot;rejected without providing a new state.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># a rule that mutates state should not fizzle itself</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="n">state</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">REJECT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateRejectDetails</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.delay_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delay_transition</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.delay_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Delays a proposed transition before the transition is validated.</p>
<p>This method will delay a proposed transition, setting the proposed state to
<code>None</code>, signaling to the <code>OrchestrationContext</code> that no state should be
written to the database. The number of seconds a transition should be delayed is
passed to the <code>OrchestrationContext</code>. A reason for delaying the transition is
also provided. Rules that delay the transition will not fizzle, despite the
proposed state type changing.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>delay_seconds</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The number of seconds the transition should be delayed</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>reason</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The reason for delaying the transition</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">delay_transition</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">delay_seconds</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delays a proposed transition before the transition is validated.</span>

<span class="sd">    This method will delay a proposed transition, setting the proposed state to</span>
<span class="sd">    `None`, signaling to the `OrchestrationContext` that no state should be</span>
<span class="sd">    written to the database. The number of seconds a transition should be delayed is</span>
<span class="sd">    passed to the `OrchestrationContext`. A reason for delaying the transition is</span>
<span class="sd">    also provided. Rules that delay the transition will not fizzle, despite the</span>
<span class="sd">    proposed state type changing.</span>

<span class="sd">    Args:</span>
<span class="sd">        delay_seconds: The number of seconds the transition should be delayed</span>
<span class="sd">        reason: The reason for delaying the transition</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># don&#39;t run if the transition is already validated</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">validated_state</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The transition is already validated&quot;</span><span class="p">)</span>

    <span class="c1"># a rule that mutates state should not fizzle itself</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">WAIT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateWaitDetails</span><span class="p">(</span>
        <span class="n">delay_seconds</span><span class="o">=</span><span class="n">delay_seconds</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="n">reason</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.abort_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">abort_transition</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.abort_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Aborts a proposed transition before the transition is validated.</p>
<p>This method will abort a proposed transition, expecting no further action to
occur for this run. The proposed state is set to <code>None</code>, signaling to the
<code>OrchestrationContext</code> that no state should be written to the database. A
reason for aborting the transition is also provided. Rules that abort the
transition will not fizzle, despite the proposed state type changing.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>reason</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The reason for aborting the transition</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">abort_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Aborts a proposed transition before the transition is validated.</span>

<span class="sd">    This method will abort a proposed transition, expecting no further action to</span>
<span class="sd">    occur for this run. The proposed state is set to `None`, signaling to the</span>
<span class="sd">    `OrchestrationContext` that no state should be written to the database. A</span>
<span class="sd">    reason for aborting the transition is also provided. Rules that abort the</span>
<span class="sd">    transition will not fizzle, despite the proposed state type changing.</span>

<span class="sd">    Args:</span>
<span class="sd">        reason: The reason for aborting the transition</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># don&#39;t run if the transition is already validated</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">validated_state</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The transition is already validated&quot;</span><span class="p">)</span>

    <span class="c1"># a rule that mutates state should not fizzle itself</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_status</span> <span class="o">=</span> <span class="n">SetStateStatus</span><span class="o">.</span><span class="n">ABORT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">response_details</span> <span class="o">=</span> <span class="n">StateAbortDetails</span><span class="p">(</span><span class="n">reason</span><span class="o">=</span><span class="n">reason</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.rename_state" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rename_state</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.rename_state" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Sets the "name" attribute on a proposed state.</p>
<p>The name of a state is an annotation intended to provide rich, human-readable
context for how a run is progressing. This method only updates the name and not
the canonical state TYPE, and will not fizzle or invalidate any other rules
that might govern this state transition.</p>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">rename_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the &quot;name&quot; attribute on a proposed state.</span>

<span class="sd">    The name of a state is an annotation intended to provide rich, human-readable</span>
<span class="sd">    context for how a run is progressing. This method only updates the name and not</span>
<span class="sd">    the canonical state TYPE, and will not fizzle or invalidate any other rules</span>
<span class="sd">    that might govern this state transition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">state_name</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseOrchestrationRule.update_context_parameters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_context_parameters</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseOrchestrationRule.update_context_parameters" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Updates the "parameters" dictionary attribute with the specified key-value pair.</p>
<p>This mechanism streamlines the process of passing messages and information
between orchestration rules if necessary and is simpler and more ephemeral than
message-passing via the database or some other side-effect. This mechanism can
be used to break up large rules for ease of testing or comprehension, but note
that any rules coupled this way (or any other way) are no longer independent and
the order in which they appear in the orchestration policy priority will matter.</p>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">update_context_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the &quot;parameters&quot; dictionary attribute with the specified key-value pair.</span>

<span class="sd">    This mechanism streamlines the process of passing messages and information</span>
<span class="sd">    between orchestration rules if necessary and is simpler and more ephemeral than</span>
<span class="sd">    message-passing via the database or some other side-effect. This mechanism can</span>
<span class="sd">    be used to break up large rules for ease of testing or comprehension, but note</span>
<span class="sd">    that any rules coupled this way (or any other way) are no longer independent and</span>
<span class="sd">    the order in which they appear in the orchestration policy priority will matter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="prefect.server.orchestration.rules.BaseUniversalTransform" class="doc doc-heading">
        <code>BaseUniversalTransform</code>


<a href="#prefect.server.orchestration.rules.BaseUniversalTransform" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>contextlib.<span title="contextlib.AbstractAsyncContextManager">AbstractAsyncContextManager</span></code></p>

  
      <p>An abstract base class used to implement privileged bookkeeping logic.</p>

<details class="warning">
  <summary>Warning</summary>
  <p>In almost all cases, use the <code>BaseOrchestrationRule</code> base class instead.</p>
</details>      <p>Beyond the orchestration rules implemented with the <code>BaseOrchestrationRule</code> ABC,
Universal transforms are not stateful, and fire their before- and after- transition
hooks on every state transition unless the proposed state is <code>None</code>, indicating that
no state should be written to the database. Because there are no guardrails in place
to prevent directly mutating state or other parts of the orchestration context,
universal transforms should only be used with care.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>FROM_STATES</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span></code>
          </td>
          <td><p>for compatibility with <code>BaseOrchestrationPolicy</code></p></td>
        </tr>
        <tr>
          <td><code>TO_STATES</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span></code>
          </td>
          <td><p>for compatibility with <code>BaseOrchestrationPolicy</code></p></td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
          </td>
          <td><p>the orchestration context</p></td>
        </tr>
        <tr>
          <td><code>from_state_type</code></td>
          <td>
          </td>
          <td><p>the state type a run is currently in</p></td>
        </tr>
        <tr>
          <td><code>to_state_type</code></td>
          <td>
          </td>
          <td><p>the intended proposed state type prior to any orchestration</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="prefect.server.orchestration.rules.OrchestrationContext" href="#prefect.server.orchestration.rules.OrchestrationContext">OrchestrationContext</a></code>
          </td>
          <td><p>A <code>FlowOrchestrationContext</code> or <code>TaskOrchestrationContext</code> that is
passed between transforms</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BaseUniversalTransform</span><span class="p">(</span><span class="n">contextlib</span><span class="o">.</span><span class="n">AbstractAsyncContextManager</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An abstract base class used to implement privileged bookkeeping logic.</span>

<span class="sd">    Warning:</span>
<span class="sd">        In almost all cases, use the `BaseOrchestrationRule` base class instead.</span>

<span class="sd">    Beyond the orchestration rules implemented with the `BaseOrchestrationRule` ABC,</span>
<span class="sd">    Universal transforms are not stateful, and fire their before- and after- transition</span>
<span class="sd">    hooks on every state transition unless the proposed state is `None`, indicating that</span>
<span class="sd">    no state should be written to the database. Because there are no guardrails in place</span>
<span class="sd">    to prevent directly mutating state or other parts of the orchestration context,</span>
<span class="sd">    universal transforms should only be used with care.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        FROM_STATES: for compatibility with `BaseOrchestrationPolicy`</span>
<span class="sd">        TO_STATES: for compatibility with `BaseOrchestrationPolicy`</span>
<span class="sd">        context: the orchestration context</span>
<span class="sd">        from_state_type: the state type a run is currently in</span>
<span class="sd">        to_state_type: the intended proposed state type prior to any orchestration</span>

<span class="sd">    Args:</span>
<span class="sd">        context: A `FlowOrchestrationContext` or `TaskOrchestrationContext` that is</span>
<span class="sd">            passed between transforms</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># `BaseUniversalTransform` will always fire on non-null transitions</span>
    <span class="n">FROM_STATES</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>
    <span class="n">TO_STATES</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="n">ALL_ORCHESTRATION_STATES</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">OrchestrationContext</span><span class="p">,</span>
        <span class="n">from_state_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">],</span>
        <span class="n">to_state_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">states</span><span class="o">.</span><span class="n">StateType</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">from_state_type</span> <span class="o">=</span> <span class="n">from_state_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_state_type</span> <span class="o">=</span> <span class="n">to_state_type</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aenter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enter an async runtime context governed by this transform.</span>

<span class="sd">        The `with` statement will bind a governed `OrchestrationContext` to the target</span>
<span class="sd">        specified by the `as` clause. If the transition proposed by the</span>
<span class="sd">        `OrchestrationContext` has been nullified on entry and `context.proposed_state`</span>
<span class="sd">        is `None`, entering this context will do nothing. Otherwise</span>
<span class="sd">        `self.before_transition` will fire.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">before_transition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">rule_signature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span>

    <span class="k">async</span> <span class="k">def</span> <span class="fm">__aexit__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">exc_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
        <span class="n">exc_val</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
        <span class="n">exc_tb</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TracebackType</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exit the async runtime context governed by this transform.</span>

<span class="sd">        If the transition has been nullified or errorred upon exiting this transforms&#39;s context,</span>
<span class="sd">        nothing happens. Otherwise, `self.after_transition` will fire on every non-null</span>
<span class="sd">        proposed state.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">exception_in_transition</span><span class="p">():</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">after_transition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">finalization_signature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements a hook that fires before a state is committed to the database.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: the `OrchestrationContext` that contains transition details</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements a hook that can fire after a state is committed to the database.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: the `OrchestrationContext` that contains transition details</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">nullified_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines if the transition has been nullified.</span>

<span class="sd">        Transitions are nullified if the proposed state is `None`, indicating that</span>
<span class="sd">        nothing should be written to the database.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the transition is nullified, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="ow">is</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">exception_in_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines if the transition has encountered an exception.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the transition is encountered an exception, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">orchestration_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseUniversalTransform.before_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">before_transition</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseUniversalTransform.before_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Implements a hook that fires before a state is committed to the database.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>context</code></td>
          <td>
          </td>
          <td><p>the <code>OrchestrationContext</code> that contains transition details</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">before_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements a hook that fires before a state is committed to the database.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: the `OrchestrationContext` that contains transition details</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseUniversalTransform.after_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">after_transition</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#prefect.server.orchestration.rules.BaseUniversalTransform.after_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Implements a hook that can fire after a state is committed to the database.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>context</code></td>
          <td>
          </td>
          <td><p>the <code>OrchestrationContext</code> that contains transition details</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>None</code>
          </td>
          <td><p>None</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">after_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements a hook that can fire after a state is committed to the database.</span>

<span class="sd">    Args:</span>
<span class="sd">        context: the `OrchestrationContext` that contains transition details</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseUniversalTransform.nullified_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nullified_transition</span></code>

<a href="#prefect.server.orchestration.rules.BaseUniversalTransform.nullified_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Determines if the transition has been nullified.</p>
<p>Transitions are nullified if the proposed state is <code>None</code>, indicating that
nothing should be written to the database.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td><p>True if the transition is nullified, False otherwise.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nullified_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines if the transition has been nullified.</span>

<span class="sd">    Transitions are nullified if the proposed state is `None`, indicating that</span>
<span class="sd">    nothing should be written to the database.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the transition is nullified, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">proposed_state</span> <span class="ow">is</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="prefect.server.orchestration.rules.BaseUniversalTransform.exception_in_transition" class="doc doc-heading">
<code class="highlight language-python"><span class="n">exception_in_transition</span></code>

<a href="#prefect.server.orchestration.rules.BaseUniversalTransform.exception_in_transition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Determines if the transition has encountered an exception.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td><p>True if the transition is encountered an exception, False otherwise.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/home/runner/work/docs/docs/prefect_source/src/prefect/server/orchestration/rules.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">exception_in_transition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines if the transition has encountered an exception.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the transition is encountered an exception, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">orchestration_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs Insiders
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.prefect.io/slack/" target="_blank" rel="noopener" title="www.prefect.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discourse.prefect.io/" target="_blank" rel="noopener" title="discourse.prefect.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9C448 134.3 348.6 32 225.9 32zM224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/c/PrefectIO/videos" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://prefect.io/guide/" target="_blank" rel="noopener" title="prefect.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M168 80c-13.3 0-24 10.7-24 24v304c0 8.4-1.4 16.5-4.1 24H440c13.3 0 24-10.7 24-24V104c0-13.3-10.7-24-24-24H168zM72 480c-39.8 0-72-32.2-72-72V112c0-13.3 10.7-24 24-24s24 10.7 24 24v296c0 13.3 10.7 24 24 24s24-10.7 24-24V104c0-39.8 32.2-72 72-72h272c39.8 0 72 32.2 72 72v304c0 39.8-32.2 72-72 72H72zm104-344c0-13.3 10.7-24 24-24h96c13.3 0 24 10.7 24 24v80c0 13.3-10.7 24-24 24h-96c-13.3 0-24-10.7-24-24v-80zm200-24h32c13.3 0 24 10.7 24 24s-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80h32c13.3 0 24 10.7 24 24s-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24s10.7-24 24-24zm-176 80h208c13.3 0 24 10.7 24 24s-10.7 24-24 24H200c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80h208c13.3 0 24 10.7 24 24s-10.7 24-24 24H200c-13.3 0-24-10.7-24-24s10.7-24 24-24z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/PrefectIO" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/prefect/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/PrefectHQ/prefect" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://hub.docker.com/r/prefecthq/prefect/" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/prefect/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["announce.dismiss", "content.action.edit", "content.code.copy", "navigation.tabs.sticky", "search.suggest", "search.highlight", "navigation.path", "navigation.indexes"], "search": "../../../../assets/javascripts/workers/search.6c7302c4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.803ed251.min.js"></script>
      
        <script src="../../../../js/termynal.js"></script>
      
        <script src="../../../../js/custom.js"></script>
      
    
  </body>
</html>